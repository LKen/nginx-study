(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10557784"],{"00c7":function(e,t,r){},"3aa0":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container new"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-title"},[r("Toolbar",{attrs:{name:e.filename,"prefix-icon":"back"},on:{"prefix-callback":e.goBack}})],1),e._v(" "),r("div",{staticClass:"card-body"},[r("div",{staticClass:"user"},[r("div",{staticClass:"user__header"},[r("g-icon",{staticClass:"user__uploadIcon",attrs:{"icon-class":"picture"},on:{click:e.handleAvatar}}),e._v(" "),r("el-avatar",{ref:"avatar",staticClass:"avatar",attrs:{icon:"el-icon-ext-users",size:150,src:e.croppedImage||e.row.customerIcoUrl}})],1),e._v(" "),r("div",{staticClass:"user__content"},[r("el-form",{ref:"dataForm",staticStyle:{width:"60%",margin:"0 auto"},attrs:{rules:e.rules,model:e.temp,"label-position":e.formAlign,size:e.formSize,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"账号"}},[r("el-input",{attrs:{disabled:!0,placeholder:""},model:{value:e.row.username,callback:function(t){e.$set(e.row,"username","string"===typeof t?t.trim():t)},expression:"row.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"身份证",prop:"idCardNo"}},[r("el-input",{attrs:{"show-password":"",placeholder:"请输入...",autocomplete:"off"},model:{value:e.temp.idCardNo,callback:function(t){e.$set(e.temp,"idCardNo","string"===typeof t?t.trim():t)},expression:"temp.idCardNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{placeholder:"请输入..."},model:{value:e.temp.nickname,callback:function(t){e.$set(e.temp,"nickname","string"===typeof t?t.trim():t)},expression:"temp.nickname"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"企业单位"}},[r("el-input",{attrs:{disabled:!0,placeholder:""},model:{value:e.row.companyName,callback:function(t){e.$set(e.row,"companyName","string"===typeof t?t.trim():t)},expression:"row.companyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色名称",prop:"roleId"}},[r("el-input",{attrs:{disabled:!0,placeholder:""},model:{value:e.row.roleName,callback:function(t){e.$set(e.row,"roleName","string"===typeof t?t.trim():t)},expression:"row.roleName"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"user__footer"},[r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.sending,expression:"sending"}],attrs:{disabled:e.sending},on:{click:e.handleSubmit}},[e._v("保存设置")])],1)])])]),e._v(" "),r("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"append-to-body":!0,top:"20vh",title:e.dialogTitle,visible:e.dialogVisible,modal:e.needModal,"close-on-click-modal":e.closeOnClickModel,width:"550px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[r("div",{staticClass:"g-cropper"},[r("div",{staticClass:"g-cropper-input"},[r("el-upload",{attrs:{action:"",accept:"image/jpeg, image/png","auto-upload":!1,"show-file-list":!1,"on-change":e.changeFiles}},[r("div",[r("span",[e._v("上传头像")]),r("small",[e._v("（只能上传jpg/png文件）")])])])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showCropper,expression:"showCropper"}],staticClass:"g-cropper-image"},[r("img",{ref:"croppedImg",attrs:{src:"",alt:"裁剪区域"}})]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showCropper,expression:"showCropper"}],staticClass:"g-cropper-preview"},[r("p",{staticClass:"text"},[r("span",[e._v("预览")])]),e._v(" "),r("div",{staticClass:"g-cropper-preview__img",staticStyle:{width:"96px",height:"96px",overflow:"hidden"}})])]),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.interceptPhoto}},[e._v("确 定")])],1)])],1)},i=[],o=(r("96cf"),r("3b8d")),s=(r("a481"),r("6107"),r("bab44")),n=r.n(s),l=r("61f7"),c=r("ed08"),p=r("0a1f"),d=p["user"].modifyCustomer,u=p["user"].searchCustomerByParam,m={name:"ClientSet",data:function(){return{formSize:"small",needModal:!0,closeOnClickModel:!1,sending:!1,dialogTitle:"头像修改",dialogVisible:!1,row:{},temp:{userId:"",nickname:"",idCardNo:"",roleId:"",file:null},file:null,rules:{idCardNo:[{required:!1,trigger:"blur",validator:function(e,t,r){t?Object(l["d"])(t)?r():r(new Error("身份证格式错误")):r()}}]},showCropper:!1,croppedImage:"",filename:this.$t("route.client-set",{})}},created:function(){},mounted:function(){var e=this.$route.params.id;this.getList(e)},methods:{goBack:function(){this.$router.replace({path:"/config-center/system-mgr/client-mgr"})},getList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,a,i,o,s,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u({id:t});case 3:r=e.sent,a=r.data.rows.length>0?r.data.rows[0]:{},this.row=a,i=a.idCardNo,o=a.id,s=a.customerNickname,n=a.roleId,this.temp=Object.assign({},this.temp,{idCardNo:i,userId:o,nickname:s,roleId:n}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));function t(t){return e.apply(this,arguments)}return t}(),closeDialog:function(){this.cropper&&this.cropper.destroy(),this.cropper=null,this.showCropper=!1},handleAvatar:function(){this.dialogVisible=!0},changeFiles:function(e,t){var r=this,a=e.raw,i=function(e){r.showCropper=!0,r.$refs["croppedImg"].src=e,r.$nextTick(r.initCropper)};if(URL)i(URL.createObjectURL(a));else if(FileReader){var o=new FileReader;o.onload=function(e){i(o.result)},o.readAsDataURL(a)}},initCropper:function(){this.cropper&&(this.cropper.destroy(),this.cropper=null),this.cropper=new n.a(this.$refs["croppedImg"],{aspectRatio:1,preview:".g-cropper-preview__img",dragMode:"move"})},getCroppedImage:function(){var e=this;return new Promise(function(t,r){var a=e.cropper.getCroppedCanvas({width:160,height:160,imageSmoothingQuality:"low"});a.toBlob?a.toBlob(function(e){t(e)}):a.msToBlob?(console.log(a.msToBlob()),t(a.msToBlob())):t(a.toDataURL())})},interceptPhoto:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.cropper){e.next=6;break}return e.next=3,this.getCroppedImage();case 3:t=e.sent,t instanceof Blob&&t.size>0?(this.file=t,this.$refs["avatar"],this.croppedImage=URL.createObjectURL(t)):(r=Object(c["a"])(t),this.croppedImage=t,this.file=r),this.$refs["avatar"].isImageExist=!0;case 6:this.$nextTick(function(){a.dialogVisible=!1});case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleSubmit:function(){var e=this;this.$refs["dataForm"].validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(r){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:try{r&&(e.sending=!0,a=e._.cloneDeep(e.temp),e.file&&(a.file=e.file),d(a).then(function(t){e.sending=!1,e.$message.success(t.msg),e.file=null},function(t){e.sending=!1,console.log(t)}))}catch(i){console.log(i)}case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}}},f=m,g=(r("8f4b"),r("2877")),h=Object(g["a"])(f,a,i,!1,null,"278d84cb",null);t["default"]=h.exports},"8f4b":function(e,t,r){"use strict";var a=r("00c7"),i=r.n(a);i.a}}]);