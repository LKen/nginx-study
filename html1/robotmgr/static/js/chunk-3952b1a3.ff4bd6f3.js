(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3952b1a3"],{"0030":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container new bg with-pagination"},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.issuing,expression:"issuing"}],staticClass:"card",attrs:{"element-loading-text":"正在下发中......"}},[s("div",{staticClass:"card-title"},[s("Toolbar",{attrs:{name:e.filename}},[s("span",{staticClass:"action",on:{click:e.getList}},[s("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" "),s("span",{staticClass:"action__desc"},[e._v(e._s(e.$t("base.search")))])],1),e._v(" "),s("span",{staticClass:"action",on:{click:e.handlePlus}},[s("svg-icon",{attrs:{"icon-class":"plus"}}),e._v(" "),s("span",{staticClass:"action__desc"},[e._v(e._s(e.$t("base.plus")))])],1)])],1),e._v(" "),s("div",{staticClass:"card-body"},[s("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[s("el-col",{attrs:{xs:12,sm:8,md:4}},[s("el-input",{staticClass:"filter-item",attrs:{size:e.searchSize,placeholder:"账号 或 手机号码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.username,callback:function(t){e.$set(e.listQuery,"username",t)},expression:"listQuery.username"}},[s("svg-icon",{staticClass:"el-input__icon",attrs:{slot:"prefix","icon-class":"description"},slot:"prefix"})],1)],1),e._v(" "),s("el-col",{attrs:{xs:12,sm:8,md:4}},[s("el-input",{staticClass:"filter-item",attrs:{size:e.searchSize,placeholder:"姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.nickname,callback:function(t){e.$set(e.listQuery,"nickname",t)},expression:"listQuery.nickname"}},[s("svg-icon",{staticClass:"el-input__icon",attrs:{slot:"prefix","icon-class":"user"},slot:"prefix"})],1)],1),e._v(" "),s("el-col",{attrs:{xs:12,sm:8,md:4}},[s("el-select",{attrs:{size:e.searchSize,placeholder:"单位"},on:{change:e.getList},model:{value:e.listQuery.companyCode,callback:function(t){e.$set(e.listQuery,"companyCode","string"===typeof t?t.trim():t)},expression:"listQuery.companyCode"}},[e._l(e.units,function(e){return s("el-option",{key:e.id,attrs:{label:e.companyName,value:e.companyCode}})}),e._v(" "),s("i",{staticClass:"el-input__icon el-icon-ext-list",attrs:{slot:"prefix"},slot:"prefix"})],2)],1)],1),e._v(" "),s("div",{staticClass:"card-table"},[s("transition-group",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"g-flexbox",attrs:{name:"flip-list",tag:"div"}},e._l(e.list&&e.list.slice(0,6),function(t){return s("div",{key:t.id,staticClass:"flip-list__item g-flexbox__item"},[s("div",{staticClass:"user"},[s("div",{staticClass:"user__head",staticStyle:{display:"none"}}),e._v(" "),s("div",{staticClass:"user__content"},[s("div",{staticClass:"user__content_image left "},[s("div",{staticClass:"user__content_image__avatar"},[s("img",{attrs:{src:i("de2b"),alt:"User Avatar"}})])]),e._v(" "),s("div",{staticClass:"user__content_info right"},[s("div",[e._v("\n                    ID："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.id)))])]),e._v(" "),s("div",[e._v("\n                    账号："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.username)))])]),e._v(" "),s("div",[e._v("\n                    姓名："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.customerNickname)))])]),e._v(" "),s("div",[e._v("\n                    最近登录："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.lastLogindate)))])]),e._v(" "),s("div",[e._v("\n                    关联机器人数："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.deviceCount)))])]),e._v(" "),s("div",[e._v("\n                    登录次数："),s("span",{staticClass:"word"},[e._v(e._s(e._f("defaultValue")(t.customerLoginTimes)))])])])]),e._v(" "),s("div",{staticClass:"user__foot"},[s("div",{staticClass:"action",on:{click:function(i){return e.handleRelevance(t)}}},[s("g-icon",{attrs:{"icon-class":"relevance"}}),e._v(" "),s("span",{staticClass:"action__desc"},[e._v("关联机器人")])],1)])])])}),0)],1)],1)]),e._v(" "),s("div",{staticClass:"pagination-container"},[s("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":e.pageSize,"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{"append-to-body":!0,top:"20vh",title:"添加用户",visible:e.dialogUserVisible,modal:e.needModal,"close-on-click-modal":e.closeOnClickModel,width:"500px"},on:{"update:visible":function(t){e.dialogUserVisible=t}}},[s("el-form",{ref:"dataForm",staticStyle:{width:"90%",margin:"0 auto"},attrs:{rules:e.rules,model:e.temp,"label-position":e.formAlign,size:e.formSize,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"账号",prop:"username"}},[s("el-input",{attrs:{placeholder:""},model:{value:e.temp.username,callback:function(t){e.$set(e.temp,"username","string"===typeof t?t.trim():t)},expression:"temp.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{placeholder:"",type:"password"},model:{value:e.temp.password,callback:function(t){e.$set(e.temp,"password","string"===typeof t?t.trim():t)},expression:"temp.password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"重复密码",prop:"password2"}},[s("el-input",{attrs:{placeholder:"",type:"password"},model:{value:e.temp.password2,callback:function(t){e.$set(e.temp,"password2","string"===typeof t?t.trim():t)},expression:"temp.password2"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"卡号",prop:"idCardNo"}},[s("el-input",{attrs:{placeholder:""},model:{value:e.temp.idCardNo,callback:function(t){e.$set(e.temp,"idCardNo","string"===typeof t?t.trim():t)},expression:"temp.idCardNo"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"姓名",prop:"nickname"}},[s("el-input",{attrs:{placeholder:""},model:{value:e.temp.nickname,callback:function(t){e.$set(e.temp,"nickname","string"===typeof t?t.trim():t)},expression:"temp.nickname"}})],1),e._v(" "),"admin"===e.eCode?s("el-form-item",{attrs:{label:"用户管理",prop:"companyCode"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"默认 - 请选择用户单位"},model:{value:e.temp.companyCode,callback:function(t){e.$set(e.temp,"companyCode",t)},expression:"temp.companyCode"}},e._l(e.units,function(e){return s("el-option",{key:e.id,attrs:{label:e.companyName,value:e.companyCode}})}),1)],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogUserVisible=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.sending,expression:"sending"}],on:{click:e.handleSaveUser}},[e._v("保存")])],1)],1),e._v(" "),s("GAssociate",{attrs:{id:e.currentId,visible:e.dialogRelevanceVisible},on:{"update:visible":function(t){e.dialogRelevanceVisible=t}}})],1)},a=[],n=i("db72"),l=i("2f62"),o=i("6aea"),c=i.n(o),r=i("0a1f"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{center:"","append-to-body":!0,top:"15vh",title:"机器人关联管理",visible:e.dialogVisible,modal:e.needModal,"close-on-click-modal":e.closeOnClickModel,"before-close":e.beforeClose,width:"850px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticStyle:{height:"450px"}},[i("div",{staticClass:"fl unrelevance"},[i("div",{staticClass:"unrelevance__head"},[e._v("未关联机器人")]),e._v(" "),i("div",{staticClass:"unrelevance__content"},[i("el-scrollbar",[i("ul",{ref:"left",staticClass:"unrelevance__list"},e._l(e.list,function(t,s){return i("li",{key:s,staticClass:"unrelevance__listItem",class:{"is-active":t.active},attrs:{"data-id":t.id},on:{click:function(i){return e.handleLeftSelected(t)},dblclick:function(i){return e.handleDblForUnRelevance(t)}}},[e._v(e._s(t.name))])}),0)])],1)]),e._v(" "),i("div",{staticClass:"fr relevance"},[i("div",{staticClass:"relevance__head"},[e._v("已关联机器人")]),e._v(" "),i("div",{staticClass:"relevance__content"},[i("el-scrollbar",[i("ul",{ref:"right",staticClass:"relevance__list"},e._l(e.list2,function(t,s){return i("li",{key:s,staticClass:"relevance__listItem",class:{"is-active":t.active},attrs:{"data-id":t.id},on:{click:function(i){return e.handleRightSelected(t)},dblclick:function(i){return e.handleDblForRelevance(t)}}},[e._v("\n              "+e._s(t.name)+"\n              "),i("el-switch",{staticClass:"relevance__switch",attrs:{"active-color":e.activeColor,"active-value":e.switchValue.activeValue,"inactive-value":e.switchValue.inactiveValue},model:{value:t.ctrlKey,callback:function(i){e.$set(t,"ctrlKey",i)},expression:"item.ctrlKey"}})],1)}),0)])],1)]),e._v(" "),i("div",{staticClass:"center"},[i("g-icon",{attrs:{"icon-class":"right2"},on:{click:e.handleRightAll}}),e._v(" "),i("g-icon",{attrs:{"icon-class":"right"},on:{click:e.handleRight}}),e._v(" "),i("g-icon",{attrs:{"icon-class":"swap"},on:{click:e.handleSwap}}),e._v(" "),i("g-icon",{attrs:{"icon-class":"left"},on:{click:e.handleLeft}}),e._v(" "),i("g-icon",{attrs:{"icon-class":"left2"},on:{click:e.handleLeftAll}})],1)]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeDialog}},[e._v("取消")]),e._v(" "),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.sending,expression:"sending"}],on:{click:e.submit}},[e._v("保存")])],1)])},u=[],p=(i("ac6a"),i("c5f6"),r["user"].findNotRelaDeviceByCustomerId),v=r["user"].findRelaDeviceByCustomerId,m=r["user"].relateCustomerDeviceBatch,f={name:"GRelevance",props:{id:{type:Number,default:null},visible:{type:Boolean,default:!1}},data:function(){return{formSize:"small",needModal:!0,closeOnClickModel:!1,dialogVisible:this.visible,activeColor:"rgba(19, 206, 102, 0.4)",switchValue:{activeValue:1,inactiveValue:0},temp:{userId:"",oldPassword:"",password:"",password2:""},list:[],list2:[],sending:!1}},watch:{id:function(e,t){this.getList()},visible:function(e){this.dialogVisible=e}},created:function(){},mounted:function(){this.id&&this.getList()},methods:{beforeClose:function(e){this.temp={userId:"",oldPassword:"",password:"",password2:""},this.$emit("update:visible",!1),e()},closeDialog:function(){this.temp={userId:"",oldPassword:"",password:"",password2:""},this.$emit("update:visible",!1),this.dialogVisible=!1},getList:function(){var e=this,t=this.id;console.log("CurrentID: "+t),p({customerId:t}).then(function(t){e.list=t.data},function(e){console.log(e)}),v({customerId:t}).then(function(t){e.list2=t.data},function(e){console.log(e)})},submit:function(){var e=this,t=this.id,i=this.list,s=this.list2,a=this._.map(i,"id").join(","),n="";s.forEach(function(e){n=n+e.id+"&"+e["ctrlKey"]+","}),console.log(n),this.sending=!0,m({customerId:t,deviceIds:a,deviceIdCtrls:n}).then(function(t){e.sending=!1,e.$message.success(t.msg),e.closeDialog()},function(t){e.sending=!1,console.log(t)})},handleRightAll:function(){var e=this.list,t=this.list2;while(e.length>0){var i=e.splice(e.length-1)[0];t.push(Object.assign({},i,{ctrlKey:0}))}},handleRight:function(){var e=this.list,t=this.list2,i=e.length-1;while(i>-1){var s=e[i];s.hasOwnProperty("active")&&s.active&&t.push(Object.assign({},e.splice(i,1)[0],{active:!1})),--i}},handleLeftAll:function(){var e=this.list,t=this.list2;while(t.length>0){var i=t.splice(t.length-1)[0];e.push(Object.assign({},i,{ctrlKey:0}))}},handleLeft:function(){var e=this.list,t=this.list2,i=t.length-1;while(i>-1){var s=t[i];s.hasOwnProperty("active")&&s.active&&e.push(Object.assign({},t.splice(i,1)[0],{active:!1})),--i}},handleSwap:function(){var e=this.list,t=this.list2,i=e.slice(0),s=t.slice(0);this.list=s,this.list2=i},handleRightSelected:function(e){var t=this.list2,i=e.active;t.splice(t.indexOf(e),1,Object.assign({},e,{active:!i}))},handleDblForUnRelevance:function(e){var t=this.list2,i=this.list;t.push(i.splice(i.indexOf(e),1)[0])},handleDblForRelevance:function(e){var t=this.list2,i=this.list;i.push(t.splice(t.indexOf(e),1)[0])},handleLeftSelected:function(e){var t=this.list,i=e.active;t.splice(t.indexOf(e),1,Object.assign({},e,{active:!i}))}}},h=f,g=(i("720d"),i("2877")),_=Object(g["a"])(h,d,u,!1,null,"aad06c28",null),b=_.exports,C=r["user"].selectCustomerCompany,y=r["user"].addCustomer,w=r["user"].deleteCustomer,k=r["user"].searchCustomerByParam,x={name:"ClientMgr",components:{GAssociate:b},data:function(){var e=this,t=function(e,t,i){t.length>9&&i(new Error("卡号长度不能大于10位")),i()},i=function(t,i,s){var a=e.temp.password;a!==i&&s(new Error("两次密码输入不一致")),s()};return{emptyText:null,list:[],total:null,listLoading:!0,listQuery:{page:1,limit:6,username:"",nickname:""},layout:!1,issuing:!1,needModal:!0,closeOnClickModel:!1,dialogUserVisible:!1,dialogRessetVisible:!1,dialogRelevanceVisible:!1,sending:!1,temp:{username:"",nickname:"",password:"",password2:"",idCardNo:"",companyCode:null},rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],password2:[{required:!0,message:"请再输入一次密码",trigger:"blur"},{trigger:"blur",validator:i}],idCardNo:[{trigger:"blur",validator:t}]},row:{},currentId:null,units:[],pageSize:[6],filename:this.$t("route.client-mgr")}},computed:Object(n["a"])({},Object(l["c"])(["eCode"])),watch:{layout:function(e){this.listQuery.limit=e?10:6,this.pageSize=e?[10,20,30,50]:[6]}},mounted:function(){this.getList(),this.getUnits()},methods:{getList:function(e){var t=this;"boolean"===typeof e&&e||(this.listQuery.page=1),this.listLoading=!0,this.emptyText=null,k(this.listQuery).then(function(e){t.list=e.data.rows,t.total=e.data.total,t.listLoading=!1},function(e){console.log(e),t.listLoading=!1,t.emptyText="网络错误"})},getUnits:function(){var e=this;"admin"===this.eCode&&0===this.units.length&&C({page:1,limit:999}).then(function(t){e.units=t.data.rows},function(e){console.log(e)})},rowKey:function(e){return e.id},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList(!0)},handlePlus:function(){var e=this;this.temp={username:"",nickname:"",password:"",password2:"",idCardNo:"",companyCode:null},this.dialogUserVisible=!0,this.$nextTick(function(){e.$refs["dataForm"]&&e.$refs["dataForm"].clearValidate()})},handleEdit:function(e){var t=e.id;this.$router.push({path:"/config-center/system-mgr/client-set/".concat(t)})},handleReset:function(e){this.row=e,this.dialogRessetVisible=!0},handleDelete:function(e){var t=this,i=e.id;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){w({userId:i}).then(function(i){t.$message.success(i.msg);var s=t.list.indexOf(e);s>-1&&t.list.splice(s,1)},function(e){console.log(e)})}).catch(function(){})},handleRelevance:function(e){"undefined"!==typeof e&&(this.currentId=e.id,this.dialogRelevanceVisible=!0)},handleSaveUser:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(t){e.sending=!0;var i=e._.cloneDeep(e.temp);i.password=c()(i.password),i.password2=c()(i.password2),y(i).then(function(t){e.$message.success(t.msg),e.sending=!1,e.dialogUserVisible=!1,t.data.username=t.data.code,e.list.unshift(t.data)},function(t){console.log(t),e.sending=!1})}})}}},V=x,$=(i("c9cb"),i("ac78"),Object(g["a"])(V,s,a,!1,null,"3592185b",null));t["default"]=$.exports},"70c4":function(e,t,i){},"720d":function(e,t,i){"use strict";var s=i("e258"),a=i.n(s);a.a},"8ff6":function(e,t,i){},ac78:function(e,t,i){"use strict";var s=i("8ff6"),a=i.n(s);a.a},c9cb:function(e,t,i){"use strict";var s=i("70c4"),a=i.n(s);a.a},de2b:function(e,t,i){e.exports=i.p+"static/img/avatar.ecba1844.gif"},e258:function(e,t,i){}}]);