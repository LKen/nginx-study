(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-841a3e86"],{"0811":function(t,e,a){"use strict";var i,n,s=a("db72"),o=a("2f62"),r=a("26a1"),l=Object(o["a"])("robot"),c=l.mapActions,d=l.mapState,u={name:"",filters:{filterOnline:function(t){return 1===t?"online":"offline"}},data:function(){return{LoadingRobot:!1,loadingText:"开始准备机器人",robotId:"",isReverse:!1,selectVisible:!1}},computed:Object(s["a"])({},Object(o["c"])(["fromRoute"]),{},d({robotsList:function(t){return t.robotsList}})),beforeRouteUpdate:function(t,e,a){console.log("%cbeforeRouteUpdate","color: #67C23A"),this.$_dispose(this.robotId),a()},beforeRouteLeave:function(t,e,a){console.log("beforeRouteLeave"),this.$_dispose(this.robotId),a()},created:function(){var t=this;this.$bus.$on("SwitchResult",function(e){t.loadingText=e?"加载数据成功":"加载数据成失败",t.LoadingRobot=!1})},methods:Object(s["a"])({$_robotVisible:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),this.isReverse=!this.isReverse,this.selectVisible=!this.selectVisible;var e=this;return this.selectVisible&&Object(r["e"])(document.body,"click",function(t){return t.preventDefault&&t.preventDefault(),e.isReverse=!1,e.selectVisible=!1,!1}),!1},$_robotChange:function(t){this.robotId=t,this.LoadingRobot=!0,this.loadingText="机器人加载中",this.changeRobotID({robotId:+t,params:{LineInfoPushSwitch:"1",FaceCapturePushSwitch:"1",RobotStatusPushSwitch:"1",CoordinatePushSwitch:"1"}}),this.update&&this.update()},$_dispose:function(t){return this.$store.dispatch("robot/disableByRobotID",{robotId:t,params:{LineInfoPushSwitch:"0",FaceCapturePushSwitch:"0",RobotStatusPushSwitch:"0",CoordinatePushSwitch:"0"}})}},c(["changeRobotID"]))},h=u,p=(a("43f2"),a("2877")),f=Object(p["a"])(h,i,n,!1,null,null,null);e["a"]=f.exports},"0920":function(t,e,a){"use strict";var i=a("1c27"),n=a.n(i);n.a},"0bf7":function(t,e,a){},"0e35":function(t,e,a){},"126a":function(t,e,a){},"163f":function(t,e,a){},1916:function(t,e,a){"use strict";var i=a("0bf7"),n=a.n(i);n.a},"1c27":function(t,e,a){},2589:function(t,e,a){"use strict";var i=a("de1d"),n=a.n(i);n.a},2760:function(t,e,a){},"43f2":function(t,e,a){"use strict";var i=a("f77e"),n=a.n(i);n.a},"44e9":function(t,e,a){"use strict";var i=a("d2a6"),n=a.n(i);n.a},"469c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"capture-detail"},[a("div",{staticClass:"row clearfix"},[a("div",{staticClass:"info fl"},[a("div",{staticClass:"label fl"},[t._v("抓拍机器人：")]),t._v(" "),a("div",{staticClass:"content text-ellipsis"},[t._v(t._s(t.robotName))])]),t._v(" "),a("div",{staticClass:"info fl"},[a("div",{staticClass:"label fl",staticStyle:{width:"85px"}},[t._v("抓拍时间：")]),t._v(" "),a("div",{staticClass:"content text-ellipsis"},[t._v(t._s(t.time))])])]),t._v(" "),a("div",{staticClass:"row clearfix"},[a("p",{staticClass:"label"},[t._v("人脸识别结果：")]),t._v(" "),a("div",{staticClass:"result"},[a("div",{staticClass:"imgBox fl"},[a("span",{staticClass:"imgBox__title"},[t._v("抓拍图片")]),t._v(" "),a("div",{staticClass:"imgBox__wrap"},[a("img",{attrs:{src:t.captureUrl,alt:"抓拍图片"}})])]),t._v(" "),0!==t.similarity&&t.registerUrl?a("div",{staticClass:"chartBox fl"},[a("el-progress",{attrs:{type:"circle",percentage:parseFloat(t.similarity.toFixed(2)),width:60,"stroke-width":2}})],1):t._e(),t._v(" "),t.registerUrl?a("div",{staticClass:"imgBox fl"},[a("span",{staticClass:"imgBox__title"},[t._v("注册图片")]),t._v(" "),a("div",{staticClass:"imgBox__wrap"},[a("img",{attrs:{src:t.registerUrl,alt:"注册图片"}})])]):t._e(),t._v(" "),a("div",{staticClass:"txtBox"},[a("p",[t._v("姓名："+t._s(t.name))]),t._v(" "),a("p",[t._v("性别："+t._s(t._f("filterGender")(t.gender)))]),t._v(" "),a("p",[t._v("年龄："+t._s(t.age))]),t._v(" "),a("p",[t._v("人员类型："+t._s(t.type))]),t._v(" "),a("p",[t._v("证件号码："+t._s(t.num))])])])]),t._v(" "),a("div",{staticClass:"row bg clearfix"},[a("p",{staticClass:"label"},[t._v("背景图片：")]),t._v(" "),a("div",{staticClass:"wrap"},[a("img",{attrs:{src:t.captureBackgroundUrl,alt:"背景图片"}})])])])},n=[],s=(a("c5f6"),{filters:{filterGender:function(t){return 1===t?"男":0===t?"女":"--"}},props:{captureUrl:{type:String,default:""},registerUrl:{type:String,default:""},captureBackgroundUrl:{type:String,default:""},name:{type:String,default:"--"},num:{type:String,default:"--"},similarity:{type:[String,Number],required:!1,default:0},robotName:{type:String,default:"--"},gender:{type:String,default:"--"},time:{type:String,default:"--"},age:{type:[String,Number],default:"--"},type:{type:String,default:"--"}},data:function(){return{}},methods:{}}),o=s,r=(a("9172"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,null,null);e["a"]=l.exports},"46d5":function(t,e,a){},"53a3":function(t,e,a){},"5b15":function(t,e,a){"use strict";var i=a("53a3"),n=a.n(i);n.a},"5b3d":function(t,e,a){t.exports=a.p+"static/img/yunpan.e663a235.png"},"806d":function(t,e,a){t.exports=a.p+"static/img/dipan.193f3468.png"},"8b6c":function(t,e,a){"use strict";var i=a("126a"),n=a.n(i);n.a},9172:function(t,e,a){"use strict";var i=a("d269"),n=a.n(i);n.a},"993a":function(t,e,a){},a21e6:function(t,e,a){"use strict";var i=a("0e35"),n=a.n(i);n.a},aef8:function(t,e,a){"use strict";var i=a("bbd4"),n=a.n(i);n.a},b948e:function(t,e,a){"use strict";var i=a("163f"),n=a.n(i);n.a},bb1a:function(t,e,a){"use strict";var i=a("2760"),n=a.n(i);n.a},bbd4:function(t,e,a){},c54c:function(t,e,a){"use strict";var i=a("993a"),n=a.n(i);n.a},c577:function(t,e,a){"use strict";var i=a("46d5"),n=a.n(i);n.a},d269:function(t,e,a){},d2a6:function(t,e,a){},d8e1:function(t,e,a){"use strict";var i=a("fdf9"),n=a.n(i);n.a},de1d:function(t,e,a){},e470:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container new"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-title"},[a("Toolbar",{attrs:{name:t.filename,"prefix-icon":t.isDashboard?"":"back"},on:{"prefix-callback":t.goBack}},[a("span",{staticClass:"action with-link",on:{click:function(e){return t.handleRedirect("config")}}},[a("g-icon",{attrs:{"icon-class":"configuration"}}),t._v(" "),a("span",{staticClass:"action__desc"},[t._v("配置")])],1),t._v(" "),a("span",{staticClass:"action with-link",on:{click:function(e){return t.handleRedirect("plan")}}},[a("g-icon",{attrs:{"icon-class":"plan"}}),t._v(" "),a("span",{staticClass:"action__desc"},[t._v("计划")])],1),t._v(" "),a("span",{staticClass:"action no-click"},[a("g-icon",{attrs:{"icon-class":"robot"}}),t._v(" "),a("el-popover",{ref:"popover",attrs:{"popper-class":"robot-popover",placement:"bottom",width:"200",trigger:"manual"},model:{value:t.selectVisible,callback:function(e){t.selectVisible=e},expression:"selectVisible"}},[a("div",{staticClass:"robot-popover__content"},[a("el-scrollbar",[a("ul",{staticClass:"robot-select"},t._l(t.robotsList,function(e){return a("li",{key:e.deviceId,staticClass:"robot-select__item",attrs:{"data-id":e.deviceId},on:{click:function(a){return t.selectClick(e.deviceId)}}},[a("span",{staticClass:"robot-select__item-name"},[t._v(t._s(e.robotName))]),t._v(" "),a("span",{staticClass:"robot-select--suffix",class:t._f("filterOnline")(e.online)},[a("svg-icon",{attrs:{"icon-class":t._f("filterOnline")(e.online)}})],1)])}),0)])],1),t._v(" "),a("span",{staticClass:"action__desc robot-select",staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},on:{click:function(e){return t.$_robotVisible(e)}},slot:"reference"},[t._v("\n              "+t._s(t.robotname)+"\n              "),a("i",{staticClass:"robot-select__caret el-input__icon el-icon-arrow-up",class:{"is-reverse":t.isReverse}})])])],1)])],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.LoadingRobot,expression:"LoadingRobot"}],staticClass:"card-body",staticStyle:{overflow:"hidden"},attrs:{"element-loading-text":t.loadingText,"element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("el-row",{staticStyle:{height:"100%"},attrs:{gutter:15}},[a("el-col",{staticClass:"left g-flex",staticStyle:{height:"100%"}},[a("el-row",{staticClass:"g-flex__item",staticStyle:{"margin-bottom":"15px",overflow:"hidden",width:"auto"},attrs:{gutter:15}},[a("el-col",{staticStyle:{height:"100%"},attrs:{xs:10,sm:8}},[a("alarm",{staticStyle:{height:"100%"}})],1),t._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{xs:14,sm:16}},[a("video-js",{staticStyle:{height:"100%"}})],1)],1),t._v(" "),a("div",{staticClass:"hidden-xs-only g-flex__capture",staticStyle:{height:"236px"}},[a("capture",{staticStyle:{height:"100%"}})],1)],1),t._v(" "),a("el-col",{staticClass:"hidden-xs-only right",staticStyle:{height:"100%"}},[a("div",{staticClass:"g-flex",staticStyle:{height:"100%","background-color":"rgba(0, 0, 0, 0.2)",padding:"18px","overflow-y":"auto"}},[a("status",{staticStyle:{"-webkit-box-flex":"1 0 120px","-ms-flex":"1 0 120px",flex:"1 0 120px","border-bottom":"1px solid rgba(255, 255, 255, .2)"}}),t._v(" "),a("controller",{staticStyle:{"-webkit-box-flex":"0 0 360px","-ms-flex":"0 0 360px",flex:"0 0 360px",height:"360px","border-bottom":"1px solid rgba(255, 255, 255, .2)"},attrs:{"device-id":t.robotId}}),t._v(" "),a("div",{staticStyle:{"-webkit-box-flex":"0 0 196px","-ms-flex":"0 0 196px",flex:"0 0 196px",height:"196px","margin-top":"20px"}},[a("maps")],1)],1)])],1)],1)])])},n=[],s=(a("a481"),a("7f7f"),a("0811")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"map-container"},[a("div",{staticClass:"map__head"},[t._v("地图名称："),a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.robotMapInfo?t.robotMapInfo.mapName:"--"))])]),t._v(" "),a("div",{staticClass:"map__center",on:{click:t.handleMapDialog}},[a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",[a(t.currentTabComponent,{tag:"component",staticClass:"map-container__item",attrs:{transform:!1,sidebar:!1}})],1)],1)],1),t._v(" "),a("div",{staticClass:"map__foot"},[a("g-icon",{class:"CommonMap"===t.currentTabComponent?"is-active":"",attrs:{"icon-class":"map",title:"激光地图"},on:{click:function(e){return e.stopPropagation(),t.handleMapChange("CommonMap")}}}),t._v(" "),a("g-icon",{class:"AerialMap"===t.currentTabComponent?"is-active":"",attrs:{"icon-class":"aerial",title:"航拍地图"},on:{click:function(e){return e.stopPropagation(),t.handleMapChange("AerialMap")}}})],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"append-to-body":!0,top:"5vh",title:t.dialogTitle,visible:t.dialogVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"1040px","destroy-on-close":!1},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.opened}},[a("div",{staticStyle:{position:"relative",width:"100%",height:"500px","background-color":"rgba(255,255,255,.2)"}},[a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",[a(t.dialogComponent,{ref:"map",tag:"component",staticClass:"map-container__item"})],1)],1),t._v(" "),a("div",{staticClass:"map-options"},t._l(t.options,function(e,i){return a("div",{key:i,staticClass:"map-options__item",class:t.openedType===e.type?"map-options__item--isActive":""},[a("span",{staticClass:"txt"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"地图类型",placement:"top-start"}},[a("span",{staticStyle:{display:"inline-block"}},[a("svg-icon",{attrs:{"icon-class":t.openedType===e.type&&e.icons[1]?e.icons[1]:e.icons[0]},nativeOn:{click:function(a){return t.handleOptionsClick(e.type)}}})],1)])],1),t._v(" "),a("ul",{staticClass:"map-btn__group"},[a("transition-group",{attrs:{name:"list"}},t._l(e.buttons,function(i){return a("li",{directives:[{name:"show",rawName:"v-show",value:t.openedType===e.type,expression:"openedType === item.type"}],key:i.icon,staticClass:"map-btn__item",class:t.dialogComponent===i.component?"map-btn__item--isActive":"",on:{click:function(e){return e.stopPropagation(),t.handleMapChange2(i.component)}}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-end",content:i.tip}},[a("span",{staticStyle:{display:"inline-block"}},[a("svg-icon",{attrs:{"icon-class":i.icon}})],1)])],1)}),0)],1)])}),0)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)])],1)},r=[],l=a("db72"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"aerialMap",attrs:{"element-loading-text":"拼命加载中","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("zr-component",{ref:"zr-components",attrs:{error:t.errorVisible},on:{resize:t.resize,loadComplete:t.loadComplete}})],1)},d=[],u=(a("ac6a"),a("768b")),h=(a("20d6"),a("96cf"),a("3b8d")),p=a("2f62"),f=a("95c0"),m=a.n(f),b=a("bc19"),v=a("c7b2"),g=a("f3a3"),y=a("55ee"),_=a("ed08"),C=a("edc0"),k=Object(p["a"])("robot"),x=k.mapState,w={name:"AerialMap",components:{ZrComponent:b["a"]},mixins:[v["a"]],props:{sidebar:{type:Boolean,default:!0},transform:{type:Boolean,default:!0}},data:function(){return{isLoaded:!1,errorVisible:!1,zrwidth:0,zrheight:0,zr:null,zposition:[0,0],zscale:[1,1],zrotation:0,group_back:null,group_overlay:null,hiddenLineInfo:!1,hiddenRobotStatus:!1,hiddenWall:!1}},computed:Object(l["a"])({},x(["robotMapInfo","robotStatus"])),watch:{robotMapInfo:function(t,e){t&&(t.lineCode===e.lineCode&&this.isLoaded?this.update():this.reset())},robotStatus:function(t,e){t&&(t.xPositionAerial===e.xPositionAerial&&t.yPositionAerial===e.yPositionAerial||this.isLoaded&&this.update())}},mounted:function(){},activated:function(){this.robotMapInfo&&this.reset()},beforeUpdate:function(){},beforeDestroy:function(){},methods:{loadComplete:function(t){console.log("loadComplete"),this.zr=t},resize:function(){this.zr&&this.reset()},reset:function(){this.zr&&this.zr.clear(),this.isLoaded=!1,this.errorVisible=!1,this.init(),this.transform&&this.$emit("mapTransform",this.group_back),this.draw().catch(this.drawErrorCallback)},start:function(){this.init(),this.transform&&this.$emit("mapTransform",this.group_back),this.draw().catch(this.drawErrorCallback)},update:function(){this.errorVisible=!1,this.group_overlay&&this.group_overlay.removeAll(),this.draw().catch(this.drawErrorCallback)},init:function(){var t=this.robotMapInfo,e=this.$refs["zr-components"].$el;if(this.zrwidth=t.picWidth,this.zrheight=t.picHeight,this.zrwidth&&this.zrheight){var a=Object(g["c"])(e,this.zrwidth,this.zrheight),i=a.left,n=a.top,s=Object(g["b"])(e,this.zrwidth,this.zrheight);this.zscale=[s,s],this.zposition=[i,n],this.group_back=new m.a.Group,this.group_overlay=new m.a.Group,this.group_overlay.silent=!0,this.zr.add(this.group_back),this.zr.add(this.group_overlay),this.zr.refreshImmediately()}},draw:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s,o,r,l,c,d,h,p,f,m,b,v,g,k,x,w,S,I,O,M,j,A,T,L,z,$,R,V,D,P,E,N,W,F,U,B,H;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.zrwidth,a=this.zrheight,i=this.group_back,n=this.group_overlay,s=this.zposition,o=this.zscale,r=this.zrotation,l=this.robotMapInfo,i||n){t.next=3;break}return t.abrupt("return");case 3:if(i.position=s.slice(0),i.scale=o.slice(0),i.rotation=r,!(i.childCount()<1)){t.next=14;break}return this.isLoaded=!1,c=l.linePicUrl3,t.next=11,Object(_["j"])(c);case 11:d=t.sent,h=Object(y["c"])(d,e,a),h&&i.add(h);case 14:if(p=this.hiddenLineInfo,f=l.pointList,Array.isArray(f)&&f.length>0){m=0,b=null,v=null;while(-1!==m)b=null,v=null,g=this._.findIndex(f,function(t){return 0!==t.radius},m+1),-1!==g?(1===g||g-m===1?v=f.slice(g-1,g+1):(b=f.slice(m,g),v=f.slice(g-1,g+1)),m=g):(b=f.slice(m),m=g),b&&(k=b.map(function(t){return[parseFloat(t.x),parseFloat(t.y)]}),x={style:{lineWidth:3,opacity:.8,stroke:"#99f3be"},shape:{points:k,smooth:0}},w=Object(y["f"])(x,e,a,s,o),w&&(p&&w.hide(),n.add(w))),v&&(S=v[0],I=S.x,O=S.y,M=v[1],j=M.x,A=M.y,T=M.radius,L=Object(C["b"])([+I,+O],[+j,+A],T),L&&(z=Object(u["a"])(L,2),$=z[0],R=z[1],V=this.calculateAngle([+I,+O],[+$,+R]),D=this.calculateAngle([+j,+A],[+$,+R]),P={style:{lineWidth:3,opacity:.8,stroke:"#99f3be"},shape:{cx:parseFloat($),cy:parseFloat(R),r:Math.abs(T),startAngle:V,endAngle:D,clockwise:D>V&&D-V<Math.PI}},E=Object(y["a"])(P,e,a,s,o),E&&(p&&E.hide(),n.add(E))))}Array.isArray(f)&&f.length>0&&f.forEach(function(t,i,r){var l="#2DAB61",c="#02E5F8",d="red",u={style:{strokeNoScale:!0,fill:c,lineWidth:2,stroke:c},shape:{cx:parseFloat(t.x),cy:parseFloat(t.y),r:5}},h=Object(y["b"])(u,e,a,s,o);0===i&&h.attr({style:{fill:l,lineWidth:2,stroke:l}}),i===r.length-1&&h.attr({style:{fill:d,lineWidth:2,stroke:d}}),h&&(p&&h.hide(),n.add(h))}),N=this.robotStatus,W=this.hiddenRobotStatus,F=N.xPositionAerial,U=N.yPositionAerial,F&&U&&(B={zlevel:3,silent:!0,scale:[1,1],style:{stroke:"rgba(60, 40, 194, 0.12)",fill:"rgba(128, 243, 71, 0.8)"},hoverable:!1},H=Object(y["h"])([F,U],B,e,a,s,o),H&&(W&&H.hide(),n.add(H))),this.group_back.dirty(),this.group_overlay.dirty(),this.isLoaded=!0;case 24:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),drawErrorCallback:function(t){console.log(t),this.errorVisible=!0,this.isLoaded=!0},calculateAngle:function(t,e){var a=Object(u["a"])(t,2),i=a[0],n=a[1],s=Object(u["a"])(e,2),o=s[0],r=s[1],l=Math.abs(Object(C["a"])([i,n],[o,r])),c=o-i,d=r-n;return c<=0&&d>=0?l:c>0&&d>0?Math.PI-l:c>=0&&d<=0?Math.PI+l:c<0&&d<0?2*Math.PI-l:void 0}}},S=w,I=(a("8b6c"),a("2877")),O=Object(I["a"])(S,c,d,!1,null,"38277e08",null),M=O.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"commonMap",attrs:{"element-loading-text":"拼命加载中","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("zr-component",{ref:"zr-components",attrs:{error:t.errorVisible},on:{resize:t.resize,loadComplete:t.loadComplete}}),t._v(" "),t.sidebar?a("div",{staticClass:"sidebar",class:t.sidebarVisible?"sidebar--open":"sidebar--hidden",on:{mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[a("div",{staticClass:"sidebar-menu"},[a("div",{staticClass:"sidebar-menuItem"},[a("span",{staticClass:"sidebar-menuItem__tag"},[t._v("路径显示")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#909399","inactive-color":"#67c23a"},on:{change:t.handleChage},model:{value:t.hiddenLineInfo,callback:function(e){t.hiddenLineInfo=e},expression:"hiddenLineInfo"}})],1),t._v(" "),a("div",{staticClass:"sidebar-menuItem"},[a("span",{staticClass:"sidebar-menuItem__tag"},[t._v("虚拟墙显示")]),t._v(" "),a("el-switch",{staticClass:"sidebar-menuItem__switch",attrs:{"active-color":"#909399","inactive-color":"#67c23a"},on:{change:t.handleChage},model:{value:t.hiddenWall,callback:function(e){t.hiddenWall=e},expression:"hiddenWall"}})],1),t._v(" "),a("div",{staticClass:"sidebar-menuItem"},[a("span",{staticClass:"sidebar-menuItem__tag"},[t._v("机器人定位")]),t._v(" "),a("el-switch",{staticClass:"sidebar-menuItem__switch",attrs:{"active-color":"#909399","inactive-color":"#67c23a"},on:{change:t.handleChage},model:{value:t.hiddenRobotStatus,callback:function(e){t.hiddenRobotStatus=e},expression:"hiddenRobotStatus"}})],1)]),t._v(" "),a("a",{staticClass:"sidebar-tab",attrs:{href:"javascript:void(0)"},on:{click:function(e){return e.preventDefault(),t.handleSidebarClick(e)}}},[t._v("地图设置"),a("i",{staticClass:"sidebar-tab__icon",class:t.sidebarVisible?"el-icon-caret-left":"el-icon-caret-right"})])]):t._e()],1)},A=[],T=Object(p["a"])("robot"),L=T.mapState,z={name:"CommonMap",components:{ZrComponent:b["a"]},mixins:[v["a"]],props:{sidebar:{type:Boolean,default:!0},transform:{type:Boolean,default:!0}},data:function(){return{isLoaded:!1,errorVisible:!1,zrwidth:0,zrheight:0,zr:null,zposition:[0,0],zscale:[1,1],zrotation:0,group_back:null,group_overlay:null,hiddenLineInfo:!1,hiddenRobotStatus:!1,hiddenWall:!1,sidebarVisible:!1}},computed:Object(l["a"])({},L(["robotMapInfo","robotStatus"])),watch:{robotMapInfo:function(t,e){t&&this.$refs["zr-components"].$el.clientWidth&&(t.lineCode===e.lineCode&&this.isLoaded?this.update():this.reset())},robotStatus:function(t,e){t&&this.$refs["zr-components"].$el.clientWidth&&(t.xPosition===e.xPosition&&t.yPosition===e.yPosition||this.isLoaded&&this.update())}},activated:function(){this.$refs["zr-components"].$el.clientWidth&&this.robotMapInfo&&this.reset()},methods:{loadComplete:function(t){this.zr=t},resize:function(){this.zr&&this.reset()},reset:function(){this.zr&&this.zr.clear(),this.isLoaded=!1,this.errorVisible=!1,this.init(),this.transform&&this.$emit("mapTransform",this.group_back),this.draw().catch(this.drawErrorCallback)},start:function(){this.init(),this.transform&&this.$emit("mapTransform",this.group_back),this.draw().catch(this.drawErrorCallback)},init:function(){var t=this.robotMapInfo,e=this.$refs["zr-components"].$el;if(e.clientWidth)if(this.zrwidth=t.picWidth,this.zrheight=t.picHeight,this.zrwidth&&this.zrheight){var a=Object(g["c"])(e,this.zrwidth,this.zrheight),i=a.left,n=a.top,s=Object(g["b"])(e,this.zrwidth,this.zrheight);this.zscale=[s,s],this.zposition=[i,n],this.group_back=new m.a.Group,this.group_overlay=new m.a.Group,this.group_overlay.silent=!0,this.zr.add(this.group_back),this.zr.add(this.group_overlay),this.zr.refreshImmediately()}else console.log("PICTURE ERROR: 缺失图片参数")},update:function(){this.errorVisible=!1,this.group_overlay&&this.group_overlay.removeAll(),this.draw().catch(this.drawErrorCallback)},draw:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s,o,r,l,c,d,h,p,f,m,b,v,g,k,x,w,S,I,O,M,j,A,T,L,z,$,R,V,D,P,E,N,W,F,U,B,H,G,Y,q,J,Z,K,Q,X,tt,et,at;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.zrwidth,a=this.zrheight,i=this.group_back,n=this.group_overlay,s=this.zposition,o=this.zscale,r=this.zrotation,l=this.robotMapInfo,i||n){t.next=3;break}return t.abrupt("return");case 3:if(i.position=s.slice(0),i.scale=o.slice(0),i.rotation=r,!(i.childCount()<1)){t.next=14;break}return this.isLoaded=!1,c=l.linePicUrl,t.next=11,Object(_["j"])(c);case 11:d=t.sent,h=Object(y["c"])(d,e,a),h&&i.add(h);case 14:if(p=this.hiddenLineInfo,f=l.pointList,Array.isArray(f)&&f.length>0){m=0,b=null,v=null;while(-1!==m)b=null,v=null,g=this._.findIndex(f,function(t){return t.radius&&0!==t.radius},m+1),-1!==g?(1===g||g-m===1?v=f.slice(g-1,g+1):(b=f.slice(m,g),v=f.slice(g-1,g+1)),m=g):(b=f.slice(m),m=g),b&&(k=b.map(function(t){return[parseFloat(t.x),parseFloat(t.y)]}),x={style:{lineWidth:3,opacity:.8,stroke:"#99f3be"},shape:{points:k,smooth:0}},w=Object(y["f"])(x,e,a,s,o),w&&(p&&w.hide(),n.add(w))),v&&(S=v[0],I=S.x,O=S.y,M=v[1],j=M.x,A=M.y,T=M.radius,L=Object(C["b"])([+I,+O],[+j,+A],T),L&&(z=Object(u["a"])(L,2),$=z[0],R=z[1],V=this.calculateAngle([+I,+O],[+$,+R]),D=this.calculateAngle([+j,+A],[+$,+R]),P={style:{lineWidth:3,opacity:.8,stroke:"#99f3be"},shape:{cx:parseFloat($),cy:parseFloat(R),r:Math.abs(T),startAngle:V,endAngle:D,clockwise:D>V&&D-V<Math.PI}},E=Object(y["a"])(P,e,a,s,o),E&&(p&&E.hide(),n.add(E))))}if(Array.isArray(f)&&f.length>0&&f.forEach(function(t,i,r){var l="#2DAB61",c="#02E5F8",d="red",u={style:{strokeNoScale:!0,fill:c,lineWidth:2,stroke:c},shape:{cx:parseFloat(t.x),cy:parseFloat(t.y),r:5}},h=Object(y["b"])(u,e,a,s,o);0===i&&h.attr({style:{fill:l,lineWidth:2,stroke:l}}),i===r.length-1&&h.attr({style:{fill:d,lineWidth:2,stroke:d}}),h&&(p&&h.hide(),n.add(h))}),N=this.robotStatus,W=this.hiddenRobotStatus,F=N.xPosition,U=N.yPosition,F&&U&&(B={zlevel:3,silent:!0,scale:[1,1],style:{stroke:"rgba(60, 40, 194, 0.12)",fill:"rgba(128, 243, 71, 0.8)"},hoverable:!1},H=Object(y["h"])([F,U],B,e,a,s,o),H&&(W&&H.hide(),n.add(H))),G=this.hiddenWall,Y=l.wall,q="#222222",J="#0000FF",Y)for(at in Z=Y.polylines,Array.isArray(Z)&&Z.length>0&&Z.forEach(function(t){var i=t.points.map(function(t){return[t.x,t.y]}),r={shape:{points:i,smooth:0},style:{stroke:q,lineWidth:1}},l=Object(y["f"])(r,e,a,s,o);l&&(G&&l.hide(),n.add(l))}),K=Y.lines,Array.isArray(K)&&K.length>0&&K.forEach(function(t){var i={style:{stroke:q,lineWidth:1},shape:{x1:t.start.x,y1:t.start.y,x2:t.end.x,y2:t.end.y,percent:1}},r=Object(y["d"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}),Q=Y.circles,Array.isArray(Q)&&Q.length>0&&Q.forEach(function(t){var i={shape:{cx:t.x,cy:t.y,r:t.radius},style:{fill:q,lineWidth:1}},r=Object(y["b"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}),X=Y.polygons,Array.isArray(X)&&X.length>0&&X.forEach(function(t){var i={style:{stroke:q,lineWidth:1},shape:{points:t.points.length<1?[]:t.points.map(function(t){return[t.x,t.y]}),smooth:0}},r=Object(y["e"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}),tt=Y.rectangles,Array.isArray(tt)&&tt.length>0&&tt.forEach(function(t){var i={shape:{x:t.start.x,y:t.start.y,width:+t.end.x-+t.start.x,height:+t.end.y-+t.start.y,r:[0,0,0,0]},style:{fill:q,lineWidth:1}},r=Object(y["g"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}),et=Y.slopes,at="",et)"circles"===at?Array.isArray(et[at])&&et[at].length>0&&et[at].forEach(function(t){var i={shape:{cx:t.x,cy:t.y,r:t.radius},style:{fill:J,lineWidth:1}},r=Object(y["b"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}):"lines"===at?Array.isArray(et[at])&&et[at].length>0&&et[at].forEach(function(t){var i={style:{stroke:J,lineWidth:1},shape:{x1:t.start.x,y1:t.start.y,x2:t.end.x,y2:t.end.y,percent:1}},r=Object(y["d"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}):"polygons"===at?Array.isArray(et[at])&&et[at].length>0&&et[at].forEach(function(t){var i={style:{fill:J,lineWidth:1},shape:{points:t.length<1?[]:t.map(function(t){return[t.x,t.y]}),smooth:0}},r=Object(y["e"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))}):"polylines"===at?Array.isArray(et[at])&&et[at].length>0&&et[at].forEach(function(t){var i=t.points.map(function(t){return[t.x,t.y]}),r={shape:{points:i,smooth:0},style:{stroke:J,lineWidth:1}},l=Object(y["f"])(r,e,a,s,o);l&&(G&&l.hide(),n.add(l))}):"rectangles"===at&&Array.isArray(et[at])&&et[at].length>0&&et[at].forEach(function(t){var i={shape:{x:t.start.x,y:t.start.y,width:+t.end.x-+t.start.x,height:+t.end.y-+t.start.y,r:[0,0,0,0]},style:{fill:J,lineWidth:1}},r=Object(y["g"])(i,e,a,s,o);r&&(G&&r.hide(),n.add(r))});this.group_back.dirty(),this.group_overlay.dirty(),this.isLoaded=!0;case 29:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),drawErrorCallback:function(t){console.log(t),this.errorVisible=!0,this.isLoaded=!0},calculateAngle:function(t,e){var a=Object(u["a"])(t,2),i=a[0],n=a[1],s=Object(u["a"])(e,2),o=s[0],r=s[1],l=Math.abs(Object(C["a"])([i,n],[o,r])),c=o-i,d=r-n;return c<=0&&d>=0?l:c>0&&d>0?Math.PI-l:c>=0&&d<=0?Math.PI+l:c<0&&d<0?2*Math.PI-l:void 0},handleChage:function(){this.isLoaded&&this.update()},handleSidebarClick:function(){var t=this.sidebarVisible,e=this.isError,a=this.sidebarTimeout;this.sidebarVisible=!e&&!t,a&&clearTimeout(a),this.sidebarTimeout=null},handleMouseEnter:function(t){var e=this.sidebarVisible,a=this.sidebarTimeout;e&&(a&&clearTimeout(a),this.sidebarTimeout=null)},handleMouseLeave:function(t){var e=this,a=this.sidebarVisible;a&&(this.sidebarTimeout=setTimeout(function(){e.sidebarVisible=!1},3e3))}}},$=z,R=(a("44e9"),Object(I["a"])($,j,A,!1,null,"ce249f58",null)),V=R.exports,D=Object(p["a"])("robot"),P=D.mapState,E={name:"Maps",components:{AerialMap:M,CommonMap:V},data:function(){return{dialogTitle:"地图详情",needModal:!0,closeOnClickModel:!1,dialogVisible:!1,currentTabComponent:"CommonMap",dialogComponent:"CommonMap",openedType:"",options:[{type:"list",icons:["list","nested"],buttons:[{icon:"aerial",tip:"航拍地图",component:"AerialMap"},{icon:"map",tip:"激光地图",component:"CommonMap"}]}]}},computed:Object(l["a"])({computedMapData:function(){var t,e=this.currentTabComponent;switch(e){case"LaserMap":t={name:e+Date.now()};break;case"FMap":t={name:e+Date.now()};break;case"CommonMap":t={name:e+Date.now()};break}return t}},P(["robotMapInfo"])),watch:{robotMapInfo:function(t,e){t&&t.lineCode!==e.lineCode&&(this.update=!0)}},methods:{handleOptionsClick:function(t){"undefined"!==typeof t&&(this.openedType===t?this.openedType="":this.openedType=t)},handleMapChange:function(t){"undefined"!==typeof t&&this.currentTabComponent!==t&&(this.currentTabComponent=t)},handleMapChange2:function(t){"undefined"!==typeof t&&this.dialogComponent!==t&&(this.dialogComponent=t)},handleMapDialog:function(){var t=this;this.dialogVisible=!0,this.$nextTick(function(){t.dialogComponent=t.currentTabComponent})},opened:function(){this.update&&(this.$refs["map"].reset(),this.update=!1)}}},N=E,W=(a("d8e1"),Object(I["a"])(N,o,r,!1,null,"7b1d4251",null)),F=W.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"status-container"},[a("el-scrollbar",[a("ul",{staticClass:"statusList"},[t._l(t.status,function(e,i){return[e.necessary||t.temp[e.key]?a("li",{key:i,staticClass:"statusList-item"},["online"===e.type?a("g-icon",{staticClass:"statusList-item__icon",class:t._f("handleOnline")(t.temp.isOnline),attrs:{title:e.tip,"icon-class":e.type}}):"battery"!==e.type?a("g-icon",{staticClass:"statusList-item__icon",attrs:{title:e.tip,"icon-class":e.type}}):a("g-icon",{staticClass:"statusList-item__icon",class:t._f("handleElectricity")({electricity:t.temp[e.key],charge:t.temp.ifChargeTask}),attrs:{title:e.tip,"icon-class":t._f("handleElectricity")({electricity:t.temp[e.key],charge:t.temp.charge})}}),t._v(" "),a("transition",{attrs:{name:"fade",mode:"out-in"}},["PM25"===e.key?a("span",{key:t.temp[e.key],staticClass:"statusList-item__label"},[t._v(t._s(t._f("handleStatus")(t.temp[e.key]))+"μg/m³")]):"stopStatus"===e.key?a("span",{key:t.temp[e.key],staticClass:"statusList-item__label"},[t._v(t._s(t._f("filterStopsStatus")(t.temp[e.key])))]):a("span",{key:t.temp[e.key],staticClass:"statusList-item__label"},[t._v(t._s(t._f("handleStatus")(t.temp[e.key])))])])],1):t._e()]})],2)])],1)},B=[],H=Object(p["a"])("robot"),G=H.mapState,Y={name:"GStatus",filters:{filterStopsStatus:function(t){return 1===t?"急停按下":0===t?"行进中":"--"},handleOnline:function(t){return"在线"===t?"online":"offline"},handleStatus:function(t){return t||"--"},handleElectricity:function(t){var e=t.electricity,a=t.ifChargeTask,i=parseFloat(e),n=0,s="battery-",o="-charging",r="";return r=i<=1?s+n:i<=30?s+(n+20):i<=50?s+(n+40):i<=70?s+(n+60):i<=90?s+(n+80):i<=100?s+(n+100):s+n,1===+a&&(r+=o),r}},data:function(){return{status:[{type:"stop",key:"stopStatus",tip:"紧急状态",necessary:!0},{type:"online",key:"isOnline",tip:"是否在线",necessary:!0},{type:"battery",key:"electricity",tip:"电量",necessary:!0},{type:"component",key:"workModelText",tip:"工作模式",necessary:!0},{type:"temperature",key:"temperature",tip:"温度",necessary:!0},{type:"humidness",key:"humidity",tip:"湿度",necessary:!0},{type:"time",key:"duration",tip:"总运行时间",necessary:!0},{type:"mileage",key:"mileage",tip:"总里程",necessary:!0},{type:"poison-gas",key:"poisonGas",tip:"毒气",necessary:!0},{type:"co2",key:"co2",tip:"二氧化碳",necessary:!0},{type:"pm25",key:"PM25",tip:"细颗粒物PM2.5",necessary:!1},{type:"smokea-alarm",key:"smokeLevel",tip:"烟雾等级",necessary:!1},{type:"ray-1",key:"alphaRay",tip:"α射线",necessary:!1},{type:"ray-2",key:"betaRay",tip:"β射线",necessary:!1},{type:"ray-1",key:"alphaRay2",tip:"第二个α射线",necessary:!1},{type:"ray-2",key:"betaRay2",tip:"第二个β射线",necessary:!1},{type:"ray-3",key:"gammaRay",tip:"伽马γ射线",necessary:!1},{type:"Neutron",key:"neutronRay",tip:"中子",necessary:!1},{type:"H2S",key:"sH2S",tip:"硫化氢",necessary:!1},{type:"SO2",key:"sSO2",tip:"二氧化硫",necessary:!1},{type:"Hz",key:"frequency",tip:"频率",necessary:!1},{type:"dB",key:"decibel",tip:"分贝",necessary:!1}],temp:{stopStatus:"",isOnline:"",electricity:"",workModelText:"",temperature:"",humidity:"",duration:"",mileage:"",poisonGas:"",co2:"",PM25:"",smokeLevel:"",alphaRay:"",betaRay:"",alphaRay2:"",betaRay2:"",gammaRay:"",neutronRay:"",sH2S:"",sSO2:"",frequency:"",decibel:""}}},computed:Object(l["a"])({},G({robotStatus:function(t){var e=this.temp,a={},i="";for(i in e)a[i]=t.robotStatus[i];return JSON.stringify(a)}})),watch:{robotStatus:function(t,e){this.temp=Object.assign({},this.temp,JSON.parse(t))}},created:function(){},mounted:function(){"string"===typeof this.robotStatus&&(this.temp=Object.assign({},this.temp,JSON.parse(this.robotStatus)))}},q=Y,J=(a("b948e"),Object(I["a"])(q,U,B,!1,null,"524e6aca",null)),Z=J.exports,K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"capture-container"},[a("div",{staticClass:"capture-head"},[a("h4",{staticClass:"capture-head__title"},[t._v(t._s(t.$t("dashboard.capture")))]),t._v(" "),a("h6",{staticClass:"capture-head__subtitle"},[t._v("仅显示最近10张抓拍，左边为最新抓拍")])]),t._v(" "),a("div",{staticClass:"capture-body"},[a("el-scrollbar",{attrs:{vertical:!1,"wrap-class":"capture-scrollbar-wrapper"}},[a("transition-group",{staticClass:"capture-body__list",attrs:{name:"flip-list",tag:"ul"}},t._l(t.latestPictures,function(e){return a("li",{key:e.id,staticClass:"flip-list__item capture-body__listItem",style:{width:t.width+"px"},on:{click:function(a){return t.openCaptureDialog(e)}}},[a("div",{staticClass:"fancybox-wrapper"},[a("fancyBox",{attrs:{open:!1,url:e.captureUrl,width:t.width-14+"px",height:t.width-14+"px"}})],1),t._v(" "),a("div",{staticClass:"capture-body__listItem-foot"},[a("span",{staticClass:"name"},[t._v(t._s(e.name||"陌生人"))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("parseTime")(e.captureTime,"{h}:{i}:{s}")))])])])}),0)],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"人脸抓拍详情","append-to-body":!0,top:"8vh",visible:t.dialogVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"700px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("capture-detail",t._b({},"capture-detail",t.data,!1)),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("确定")])],1)],1)],1)},Q=[],X=a("469c"),tt=Object(p["a"])("websocketStore"),et=tt.mapState,at=Object(p["a"])("robot"),it=at.mapState,nt={name:"GCapture",filters:{filterTime:function(t){}},components:{CaptureDetail:X["a"]},data:function(){return{needModal:!0,closeOnClickModel:!1,dialogVisible:!1,width:window.innerWidth>1400?124:86,data:{}}},computed:Object(l["a"])({},et({latestPictures:function(t){return t.faceCaptureInfo}}),{},it({robotsList:function(t){return t.robotsList}})),created:function(){},mounted:function(){},methods:{openCaptureDialog:function(t){var e=t.captureUrl,a=t.registerUrl,i=t.captureBackgroundUrl,n=t.name,s=t.gender,o=t.age,r=t.certificateId,l=t.similarityThreshold,c=t.captureTime,d=t.deviceId,u=t.personTypeName,h="",p=this.robotsList;p.some(function(t){return t.deviceId===d&&(h=t.robotName,!0)}),this.data={captureUrl:e,registerUrl:a,captureBackgroundUrl:i,similarity:l,robotName:h,name:n||"陌生人",num:r||"--",gender:s,time:Object(_["l"])(c)||"--",age:o||"--",type:u||"--"},this.dialogVisible=!0}}},st=nt,ot=(a("1916"),a("c577"),Object(I["a"])(st,K,Q,!1,null,"54fdfa57",null)),rt=ot.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"alarm-container"},[a("div",{staticClass:"alarm-head"},[a("h4",{staticClass:"alarm-head__title"},[t._v(t._s(t.$t("dashboard.alarm")))]),t._v(" "),a("h6",{staticClass:"alarm-head__subtitle"},[t._v("实时更新，若想查阅更多，请点击右上角图标")]),t._v(" "),a("transition-group",{staticClass:"alarm-head__icon--suffix",attrs:{name:"flip-list",tag:"span"}},[a("router-link",{key:"redirect",staticClass:"flip-list__item",attrs:{to:"/data-center/records-query/alarm-query"}},[a("el-tooltip",{attrs:{effect:"dark",content:t.$t("base.more"),placement:"top"}},[a("span",[a("svg-icon",{attrs:{hover:!0,"icon-class":"more"}})],1)])],1)],1)],1),t._v(" "),a("div",{staticClass:"alarm-body"},[a(t.currentTabComponent,{tag:"component"})],1)])},ct=[],dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{staticClass:"alarm-form",staticStyle:{width:"100%"},attrs:{data:t.computedTableList,"row-key":t.rowKey,fit:"","empty-text":t.emptyText,"highlight-current-row":"",height:"100%"}},[a("el-table-column",{attrs:{align:t.textAlign,label:"图片",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("fancyBox",{attrs:{url:t.row.pics&&t.row.pics.length>0?t.row.pics[0]:t.row.defaultPic,width:"45px",height:"45px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{align:t.textAlign,label:"类型","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.alarmNameZh)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:t.textAlign,label:"时间","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.alarmBeginTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:t.textAlign,label:"级别",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===+e.row.alarmLevel?a("span",{staticStyle:{color:"#DC4B3F"}},[t._v("严重")]):2===+e.row.alarmLevel?a("span",{staticStyle:{color:"#E67F22"}},[t._v("重要")]):3===+e.row.alarmLevel?a("span",{staticStyle:{color:"#F1C40F"}},[t._v("一般")]):a("span",[t._v("--")])]}}])})],1)},ut=[],ht={name:"GAlarmList",data:function(){return{emptyText:null,textAlign:"center"}},computed:Object(l["a"])({computedTableList:function(){var t=this.latestAlarms,e=this.robotID,a=[];return e?(t.forEach(function(t){t.deviceId===e&&a.push(t)}),a):a}},Object(p["d"])({robotID:function(t){return t.robot.robotID},latestAlarms:function(t){return t.websocketStore.latestAlarms}})),mounted:function(){},methods:{rowKey:function(t){return t.id}}},pt=ht,ft=(a("c54c"),a("aef8"),Object(I["a"])(pt,dt,ut,!1,null,"61c5bfe8",null)),mt=ft.exports,bt=Object(p["a"])("robot"),vt=bt.mapState,gt={name:"GAlarm",components:{AlarmList:mt},data:function(){var t={time:this.$t("dashboard.alarmChart.time"),title:this.$t("dashboard.alarmChart.title")};return{lang:t,isLoaded:!1,currentTabComponent:"AlarmList",sourceData:null}},computed:Object(l["a"])({computedSourceData:function(){var t=this.sourceData;if("AlarmChart"===this.currentTabComponent){var e=[];return t&&Array.isArray(t)?(e=t.map(function(t){var e=t.alarmName,a=t.alarmNum;return[e,a]}),e.unshift(["AlarmType",this.lang.time])):e.push([]),{title:{text:this.lang.title},grid:{width:"95%",height:"85%",top:"15%",left:"3%",bottom:"0%",right:"2%"},dataset:{source:e},yAxis:{name:this.lang.time}}}return""}},vt({robotID:function(t){return t.robotID}})),watch:{},created:function(){},mounted:function(){},methods:{}},yt=gt,_t=(a("5b15"),a("a21e6"),Object(I["a"])(yt,lt,ct,!1,null,"7cd0186b",null)),Ct=_t.exports,kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],ref:"video-container",staticClass:"video-container"},[a("div",{staticClass:"video-head"},[a("h4",{staticClass:"video-head__title"},[t._v(t._s(t.$t("dashboard.video")))]),t._v(" "),a("div",{staticClass:"video-head__icon--suffix"},[a("div",{staticClass:"channel-wrapper"},[a("span",{staticClass:"label"},[t._v("选择摄像头：")]),t._v(" "),t.mini?a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t.handleChannelChange},model:{value:t.currentChannelId,callback:function(e){t.currentChannelId=e},expression:"currentChannelId"}},t._l(t.deviceChannels,function(t){return a("el-option",{key:t.channelId,attrs:{label:t.name,value:t.channelId}})}),1):a("el-radio-group",{on:{change:t.handleChannelChange},model:{value:t.currentChannelId,callback:function(e){t.currentChannelId=e},expression:"currentChannelId"}},t._l(t.deviceChannels,function(e){return a("el-radio",{key:e.channelId,attrs:{label:e.channelId}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),a("span",{staticClass:"column-line"}),t._v(" "),"在线"!==t.isOnline||90!==+t.robotModel&&130!==+t.robotModel?t._e():a("el-tooltip",{attrs:{effect:"dark",content:t.$t("navbar.microphone"),placement:"top"}},[a("g-icon",{attrs:{hover:!0,"icon-class":"microphone"},on:{click:function(e){return e.preventDefault(),t.handleWebrtc(e)}}})],1),t._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:t.ifChargeTask?"取消充电":"一键充电",placement:"top"}},[a("g-icon",{attrs:{hover:!0,"icon-class":"charge"},on:{click:function(e){return e.preventDefault(),t.handleOneKeyCharge(e)}}})],1),t._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:t.$t("base.refresh"),placement:"top"}},[a("g-icon",{attrs:{hover:!0,"icon-class":"refresh"},on:{click:function(e){return e.preventDefault(),t.handleRefresh(e)}}})],1)],1)]),t._v(" "),a("div",{staticClass:"video-body"},[a("section",{directives:[{name:"show",rawName:"v-show",value:t.currentVideoUrl,expression:"currentVideoUrl"},{name:"loading",rawName:"v-loading",value:!t.videoLoaded,expression:"!videoLoaded"}],staticClass:"video-body__content"},[a("div",{ref:"video",staticStyle:{width:"100%",height:"100%"},attrs:{id:"video"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.currentVideoUrl,expression:"!currentVideoUrl"}],staticClass:"error"},[a("g-icon",{attrs:{"icon-class":"media"}}),t._v(" "),a("p",[t._v("暂无视频")])],1)])])},xt=[],wt=a("0a1f"),St=Object(p["a"])("robot"),It=St.mapState,Ot=wt["device"].selectDeviceChannel,Mt=wt["device"].getVideoUrl,jt=wt["patrol"].sendMQComandByUTF8;function At(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=arguments.length>2?arguments[2]:void 0;return'<?xml version="1.0" encoding="utf-8" ?>\n  <Root>\n    <Header>\n      <CmdType>RC_Robot_Ctrl</CmdType>\n      <To>'.concat(t,"</To>\n      <From>Clientwpf</From>\n    </Header>\n    <Robot_Ctrl>\n      <unCtrlType>").concat(e,"</unCtrlType>\n      <unCtrlValue>").concat(a,"</unCtrlValue>\n    </Robot_Ctrl>\n  </Root>")}var Tt=null,Lt={name:"GVideo",components:{},data:function(){return{isLoaded:!0,videoLoaded:!0,deviceChannels:null,currentChannelId:null,currentVideoUrl:null,thumbnail:"http://www.gosunyun.com:8080/webdav/defaultimg/defautCamera.png",playerOptions:{container:"#video",variable:"myPlayer",fullInteractive:!1,definition:!1,autoplay:!0,live:!0,logo:"",loaded:"loadedHandler",volume:.8},mini:!1}},computed:Object(l["a"])({},It({robotModel:function(t){return t.robotStatus.robotModel},robotID:function(t){return t.robotID},isOnline:function(t){return t.robotStatus.isOnline},ifChargeTask:function(t){return!!+t.robotStatus.ifChargeTask||!1}}),{},Object(p["c"])({sidebar:"sidebar"})),watch:{robotID:function(t,e){var a=this;t&&t!==e&&(this.isLoaded=!1,this.$nextTick(function(){return a.handleRefresh(t)}))},currentVideoUrl:function(t,e){var a=this;t&&this.$nextTick(function(){var e=a._.extend({},a.playerOptions,{video:t});Tt=new ckplayer(e),a.currentVideoUrl=t})},"sidebar.opened":function(t,e){setTimeout(this.resize,500)}},beforeMount:function(){window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},mounted:function(){this.fetchDeviceChannels(this.robotID),this.resize()},methods:{resize:function(){var t=this.$refs["video-container"].$el.clientWidth;this.mini=t<720},fetchDeviceChannels:function(t){var e=this;t&&(this.isLoaded=!1,Ot({deviceId:t}).then(function(t){e.deviceChannels=t.data,e.isLoaded=!0},function(t){e.isLoaded=!0,console.log(t)}))},fetchVideoUrl:function(){var t=this,e=this.currentChannelId,a=this.robotID;Mt({channelId:e,clientIp:a,protocol:"hls"}).then(function(e){t.currentVideoUrl=e.data?e.data.url:""},function(t){return console.log(t)})},handleChannelChange:function(t){var e=this;"undefined"!==typeof t&&(Tt&&Tt.playOrPause(),this.currentVideoUrl=null,Tt=null,this.$refs["video"]&&(this.$refs["video"].innerHTML=""),this.$nextTick(function(){e.fetchVideoUrl()}))},handleRefresh:function(){this.fetchDeviceChannels(this.robotID),this.currentChannelId=null,this.currentVideoUrl=null,Tt=null,this.$refs["video"]&&(this.$refs["video"].innerHTML="")},handleOneKeyCharge:function(){var t=this.ifChargeTask?0:1,e=At(this.robotID,2,t);jt({deviceId:this.robotID,content:e}).catch(function(t){return console.log(t)})},handleWebrtc:function(){this.$bus.$emit("WebRtc:open")}}},zt=Lt,$t=(a("2589"),Object(I["a"])(zt,kt,xt,!1,null,"1a9ffff6",null)),Rt=$t.exports,Vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"controller-container"},[i("section",{staticClass:"mode clearfix"},[i("span",{staticClass:"mode__label fl"},[t._v("运行模式：")]),t._v(" "),i("div",{staticClass:"mode__radio"},[i("el-radio-group",{on:{change:t.handleModeChage},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}},[i("el-radio",{directives:[{name:"popover",rawName:"v-popover:mode",arg:"mode"}],staticStyle:{"margin-bottom":"16px"},attrs:{label:"0"}},[t._v("自动巡航")]),t._v(" "),i("el-radio",{staticStyle:{"margin-bottom":"16px"},attrs:{label:"1"}},[t._v("手动模式")]),t._v(" "),i("el-radio",{attrs:{label:"2"}},[t._v("值守模式")]),t._v(" "),i("el-radio",{attrs:{label:"3"}},[t._v("一键到达")])],1)],1),t._v(" "),i("el-popover",{ref:"mode",attrs:{placement:"top",trigger:"manual",width:"220"},model:{value:t.modeVisible,callback:function(e){t.modeVisible=e},expression:"modeVisible"}},[i("p",{staticStyle:{"margin-top":"0"}},[t._v("巡逻参数：")]),t._v(" "),i("el-radio-group",{staticStyle:{"margin-bottom":"1rem"},model:{value:t.mode_extend,callback:function(e){t.mode_extend=e},expression:"mode_extend"}},[i("el-radio",{attrs:{label:"0"}},[t._v("继续上次")]),t._v(" "),i("el-radio",{attrs:{label:"1"}},[t._v("重新开始")])],1),t._v(" "),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleModeExtend}},[t._v("确定")])],1)],1)],1),t._v(" "),i("section",{staticClass:"controller clearfix"},[i("div",{staticClass:"g-tabs__nav-wrap"},[i("div",{staticClass:"g-tabs__nav"},[i("span",{class:{"g-tabs__item":!0,"is-active":"yuntai"===t.activeName},attrs:{"data-type":"yuntai"},on:{click:function(e){t.activeName="yuntai"}}},[t._v("云台控制")]),t._v(" "),i("span",{class:{"g-tabs__item":!0,"is-active":"dipan"===t.activeName},attrs:{"data-type":"dipan"},on:{click:function(e){t.activeName="dipan"}}},[t._v("底盘控制")])])]),t._v(" "),i("div",{ref:"agent",staticClass:"g-tabs__content"},["yuntai"===t.activeName?[i("div",{staticClass:"img-wrap"},[i("img",{attrs:{src:a("5b3d"),alt:"云台控制"}}),t._v(" "),i("div",{staticClass:"actions clearfix"},[i("span",{staticClass:"circle"}),t._v(" "),i("g-icon",{staticClass:"top",attrs:{"icon-class":"triangle","data-type":"Y-top"}}),t._v(" "),i("g-icon",{staticClass:"right",attrs:{"icon-class":"triangle","data-type":"Y-right"}}),t._v(" "),i("g-icon",{staticClass:"bottom",attrs:{"icon-class":"triangle","data-type":"Y-bottom"}}),t._v(" "),i("g-icon",{staticClass:"left",attrs:{"icon-class":"triangle","data-type":"Y-left"}}),t._v(" "),i("g-icon",{staticClass:"center",attrs:{"icon-class":"reset","data-type":"Y-center"}})],1)]),t._v(" "),i("div",{staticClass:"tools"},[i("g-icon",{attrs:{"icon-class":"up","data-type":"Y-up"}}),t._v(" "),i("g-icon",{attrs:{"icon-class":"down","data-type":"Y-down"}}),t._v(" "),i("div",{staticClass:"divider"}),t._v(" "),i("g-icon",{attrs:{"icon-class":"plus","data-type":"Y-plus"}}),t._v(" "),i("g-icon",{attrs:{"icon-class":"minus","data-type":"Y-minus"}})],1)]:"dipan"===t.activeName?[i("div",{staticClass:"img-wrap"},[i("img",{attrs:{src:a("806d"),alt:"底盘控制"}}),t._v(" "),i("div",{staticClass:"actions clearfix"},[i("span",{staticClass:"circle"}),t._v(" "),i("g-icon",{staticClass:"top",attrs:{"icon-class":"triangle","data-type":"D-top"}}),t._v(" "),i("g-icon",{staticClass:"right",attrs:{"icon-class":"triangle","data-type":"D-right"}}),t._v(" "),i("g-icon",{staticClass:"bottom",attrs:{"icon-class":"triangle","data-type":"D-bottom"}}),t._v(" "),i("g-icon",{staticClass:"left",attrs:{"icon-class":"triangle","data-type":"D-left"}}),t._v(" "),i("g-icon",{staticClass:"center",attrs:{"icon-class":"start","data-type":"D-center"}})],1)])]:t._e()],2)])])},Dt=[],Pt=(a("28a5"),a("c5f6"),a("26a1")),Et=Object(p["a"])("robot"),Nt=Et.mapState,Wt=wt["qpid"].changeControl,Ft=wt["patrol"].sendMQComandByUTF8,Ut=1,Bt=3,Ht=5,Gt=7,Yt=9,qt=10,Jt=12,Zt=13,Kt=14,Qt={top:Ut,right:Bt,bottom:Ht,left:Gt,center:Jt,up:Zt,down:Kt,plus:Yt,minus:qt},Xt={top:1,right:8,bottom:2,left:4,center:0};function te(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40;return'<?xml version="1.0" encoding="utf-8" ?>\n  <Root>\n    <Header>\n      <CmdType>RC_Robot_PTZ_Ctrl</CmdType>\n      <To>'.concat(t,"</To>\n      <From>Clientwpf</From>\n    </Header>\n    <Robot_PTZ_Ctrl>\n      <unCtrlValue>").concat(e,"</unCtrlValue>\n      <Value>").concat(a,"</Value>\n    </Robot_PTZ_Ctrl>\n  </Root>")}function ee(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40;return'<?xml version="1.0" encoding="utf-8" ?>\n  <Root>\n    <Header>\n      <CmdType>RC_RobotMove_Ctrl</CmdType>\n      <To>'.concat(t,"</To>\n      <From>Clientwpf</From>\n    </Header>\n    <Move>\n      <Action>").concat(e,"</Action>\n      <Speed>").concat(a,"</Speed>\n    </Move>\n  </Root>")}var ae={name:"GController",props:{deviceId:{type:[String,Number],default:""}},data:function(){return{mode:"",mode_extend:"0",activeName:"yuntai",modeVisible:!1}},computed:Object(l["a"])({},Nt({workModel:function(t){return t.robotStatus.workModel}})),watch:{workModel:function(t){t!==this.mode&&(this.mode=t)}},beforeDestroy:function(){this.$refs["agent"]&&Object(Pt["c"])(this.$refs["agent"],"mousedown",this.handleAgentClick()),this.$refs["yuntaitools"]&&Object(Pt["c"])(this.$refs["yuntaitools"],"mousedown",this.handleYunToolsClick()),this.$refs["di"]&&Object(Pt["c"])(this.$refs["di"],"mousedown",this.handleYunToolsClick())},created:function(){},mounted:function(){var t=this;t.$refs["agent"]&&Object(Pt["d"])(t.$refs["agent"],"mousedown",t.handleAgentClick()),t.$refs["agent"]&&Object(Pt["d"])(t.$refs["agent"],"mouseup",function(){t.__AgentInterval&&clearInterval(t.__AgentInterval)})},methods:{handleModeChage:function(t){"0"===t?this.modeVisible=!0:(this.modeVisible=!1,this.sendMode())},sendMode:function(){var t=this,e=this.deviceId,a=this.mode,i=this.mode_extend;Wt({deviceId:e,carmode:a,extend:i}).then(function(e){t.$message.success(e.msg)},function(t){console.log(t)})},handleModeExtend:function(){var t=this;this.mode_extend;this.modeVisible=!1,this.$nextTick(function(){t.sendMode()})},handleAgentClick:function(){var t=this;return this.__handleAgentClick||(this.__handleAgentClick=this._.debounce(function(e){e.stopPropagation&&e.stopPropagation();var a=e.target||e.srcElement;if("I"===a.nodeName)a=a.parentElement;else if("SPAN"!==a.nodeName)return!1;var i=t.deviceId,n=a.dataset.type.split("-"),s=n[0],o=n[1],r="Y"===s?"center"===o?te(i,Qt[o],12):te(i,Qt[o]):ee(i,Xt[o]);t.send(i,r),t.__AgentInterval&&clearInterval(t.__AgentInterval),t.__AgentInterval="center"!==o?setInterval(function(){t.send(i,r)},400):null},350,{leading:!0,trailing:!1})),this.__handleAgentClick},send:function(t,e){Ft({deviceId:t,content:e},{notip:!0}).then(function(t){},function(t){console.log(t)})}}},ie=ae,ne=(a("0920"),Object(I["a"])(ie,Vt,Dt,!1,null,"78686d58",null)),se=ne.exports,oe={name:"RobotView",components:{Maps:F,Status:Z,Capture:rt,Alarm:Ct,VideoJs:Rt,Controller:se},mixins:[s["a"]],data:function(){return{firstLoad:!0,robotId:"",isDashboard:!1,filename:this.$t("route.robot-view",{})}},computed:{robotname:function(){var t=this.$store.getters["robot/getRobotById"](this.robotId);return t?t.robotName:"--"}},created:function(){console.log("created");var t=this.$route.query.id;if("dashboard"===this.$route.name){this.isDashboard=!0;var e=this.robotsList;Array.isArray(e)&&e.length>0&&(t=this.filterRobot(e))}if(t)this.$_robotChange(t),this.firstLoad=!1;else var a=this.$watch("robotsList",function(t){if(!this.firstLoad||this.robotId||!this.isDashboard)return!1;var e=this.filterRobot(t);e&&(this.$_robotChange(e),this.firstLoad=!1,a())})},mounted:function(){},methods:{goBack:function(){this.$router.replace({path:"/config-center/system-mgr/robot-mgr"})},handleRedirect:function(t){var e=this.robotId,a=this.robotsList;if(e)if("config"===t)this.$router.push({path:"/manager/config/".concat(e)});else{var i=1,n="";a.some(function(t){return+t.deviceId===e&&(i=t.ver,n=t.naviType,!0)}),this.$router.push({path:"/manager/plan/".concat(e),query:{ver:i,naviType:n}})}else this.$message.warning("初始化机器人ID失败，无法跳转")},selectClick:function(t){var e=this,a=this.robotId;if(!a||t===a)return!1;this.$_dispose(a).then(function(a){e.LoadingRobot=!0,e.loadingText="开始准备机器人",e.isReverse=!1,e.selectVisible=!1,e.$_robotChange(t)})},filterRobot:function(t){var e="",a=null,i=t.some(function(t){return 1===+t.online?(e=t.deviceId,!0):(a||(a=t.deviceId),!1)});return i||(e=a),e}}},re=oe,le=(a("bb1a"),Object(I["a"])(re,i,n,!1,null,"c29065d4",null));e["default"]=le.exports},edc0:function(t,e,a){"use strict";a.d(e,"a",function(){return s}),a.d(e,"b",function(){return o});var i=a("768b");function n(){throw new Error("Missing parameter")}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=Object(i["a"])(t,2),a=e[0],s=e[1],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=Object(i["a"])(o,2),l=r[0],c=r[1],d=l-a,u=c-s;return 0===d?Math.P2/2:0===u?0:Math.atan(u/d)}function o(t,e,a){var n=Object(i["a"])(t,2),s=n[0],o=n[1],r=Object(i["a"])(e,2),l=r[0],c=r[1],d=(s+l)/2,u=(o+c)/2,h=Math.sqrt(Math.pow(l-s,2)+Math.pow(c-o,2)),p=h/2;if(p>Math.abs(a))return console.log("半径数据有误",[s,o],[l,c],a),!1;var f=Math.sqrt(Math.pow(a,2)-Math.pow(p,2));if(0===f)return[d,u];var m=a<0?o-c:c-o,b=a<0?l-s:s-l;return[m/h*f+d,b/h*f+u]}},f77e:function(t,e,a){},fdf9:function(t,e,a){}}]);