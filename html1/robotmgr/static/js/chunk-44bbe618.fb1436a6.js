(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44bbe618"],{"0cb3":function(e,t,i){"use strict";var s=i("a36f"),n=i.n(s);n.a},"4baf":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container new bg with-pagination"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-title"},[i("Toolbar",{attrs:{name:e.filename}},[i("span",{staticClass:"action",on:{click:e.getList}},[i("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" "),i("span",{staticClass:"action__desc"},[e._v(e._s(e.$t("base.search")))])],1),e._v(" "),i("span",{staticClass:"action",on:{click:e.handlePlus}},[i("svg-icon",{attrs:{"icon-class":"plus"}}),e._v(" "),i("span",{staticClass:"action__desc"},[e._v(e._s(e.$t("base.plus")))])],1)])],1),e._v(" "),i("h6",{staticClass:"card-subtitle"},[e._v("创建、编辑机器人语音播报设置，设置成功后，请及时下发")]),e._v(" "),i("div",{staticClass:"card-body"},[i("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-input",{staticClass:"filter-item",attrs:{size:e.searchSize,placeholder:"'描述'"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.describe,callback:function(t){e.$set(e.listQuery,"describe",t)},expression:"listQuery.describe"}},[i("i",{staticClass:"el-input__icon el-icon-document",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-input",{staticClass:"filter-item",attrs:{size:e.searchSize,placeholder:"'播报正文'"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.voiceText,callback:function(t){e.$set(e.listQuery,"voiceText",t)},expression:"listQuery.voiceText"}},[i("i",{staticClass:"el-input__icon el-icon-document",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-select",{staticClass:"filter-item robotList__select",attrs:{filterable:"",placeholder:"下发的机器人",size:e.searchSize},model:{value:e.currentRobotId,callback:function(t){e.currentRobotId=t},expression:"currentRobotId"}},[e._l(e.robotsList,function(t){return i("el-option",{key:t.deviceId,attrs:{label:t.robotName,value:t.deviceId}},[e._v("\n              "+e._s(t.robotName)+"\n              "),i("span",{staticClass:"robotList__select--suffix",class:e._f("handleOnline")(t.online)},[i("svg-icon",{attrs:{"icon-class":e._f("handleOnline")(t.online)}})],1)])}),e._v(" "),i("svg-icon",{attrs:{slot:"prefix","class-name":"el-input__icon","icon-class":"list"},slot:"prefix"})],2)],1)],1),e._v(" "),i("div",{staticClass:"card-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.list,"row-key":e.rowKey,fit:"","empty-text":e.emptyText,"highlight-current-row":""}},[i("el-table-column",{attrs:{align:e.tableAlign,label:"描述",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.describe))]}}])}),e._v(" "),i("el-table-column",{attrs:{align:e.tableAlign,label:"播报正文"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.voiceText)+"\n            ")]}}])}),e._v(" "),i("el-table-column",{attrs:{align:e.tableAlign,label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("i",{staticClass:"gosuncn-icon el-icon-ext-edit card-table__icon",staticStyle:{cursor:"pointer"},on:{click:function(i){return e.handleEdit(t.row)}}}),e._v(" "),i("i",{staticClass:"gosuncn-icon  el-icon-ext-delete card-table__icon",staticStyle:{cursor:"pointer"},on:{click:function(i){return e.handleDelete(t.row)}}}),e._v(" "),i("el-tooltip",{attrs:{effect:"dark",content:"实时下发语音",placement:"top"}},[i("i",{staticClass:"gosuncn-icon  el-icon-ext-issue card-table__icon",on:{click:function(i){return e.handleIssue(t.row)}}})])]}}])})],1)],1)],1)]),e._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{"append-to-body":!0,top:"25vh",title:e.dialogTitle,visible:e.dialogVisible,modal:e.needModal,"close-on-click-modal":e.closeOnClickModel,width:"550px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.hanleBeforeClose}},[i("el-form",{ref:"dataForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{rules:e.rules,model:e.temp,"label-position":e.formAlign,"label-width":"100px",size:e.formSize}},[i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{placeholder:""},model:{value:e.temp.describe,callback:function(t){e.$set(e.temp,"describe","string"===typeof t?t.trim():t)},expression:"temp.describe"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"播报正文",prop:"voiceText"}},[i("el-input",{attrs:{type:"textarea",rows:6,placeholder:""},model:{value:e.temp.voiceText,callback:function(t){e.$set(e.temp,"voiceText","string"===typeof t?t.trim():t)},expression:"temp.voiceText"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.sending,expression:"sending"}],on:{click:e.handleSave}},[e._v("保存")])],1)],1)],1)},n=[],l=(i("20d6"),i("db72")),a=i("2f62"),o=i("0a1f"),c=Object(a["a"])("robot"),r=c.mapState,d=o["device"].searchVoiceTextList,u=o["device"].deleteVoiceText,f=o["device"].voiceSoundtextSet,p=o["device"].addVoiceText,g=o["device"].modifyVoiceText,v={name:"VoiceConfig",filters:{handleOnline:function(e){return 1===e?"online":"offline"}},data:function(){return{emptyText:null,list:[],total:null,listLoading:!0,listQuery:{page:1,limit:10,describe:"",voiceText:""},dialogTitle:"添加语音播报",needModal:!0,closeOnClickModel:!1,dialogVisible:!1,sending:!1,temp:{voiceId:null,describe:"",voiceText:""},rules:{describe:[{required:!0,message:"描述不能为空",trigger:"blur"}],voiceText:[{required:!0,message:"播报正文不能为空",trigger:"blur"}]},currentRobotId:null,filename:this.$t("route.voice-config")}},computed:Object(l["a"])({},r({robotsList:function(e){return e.robotsList}})),created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,this.emptyText=null,d(this.listQuery).then(function(t){e.list=t.data.rows,e.total=t.data.total,e.listLoading=!1},function(t){console.log(t),e.listLoading=!1,e.emptyText="网络错误"})},rowKey:function(e){return e.id},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},hanleBeforeClose:function(){this.$refs["dataForm"].clearValidate(),this.temp={voiceId:null,describe:"",voiceText:""}},handlePlus:function(){this.dialogVisible=!0},handleEdit:function(e){var t=e.id,i=e.describe,s=e.voiceText;this.dialogTitle="编辑语音播报",this.temp=Object.assign({},this.temp,{voiceId:t,describe:i,voiceText:s}),this.dialogVisible=!0},handleDelete:function(e){var t=this,i=e.id,s=this.list;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){u({voiceId:i}).then(function(i){t.$message.success(i.msg);var n=s.indexOf(e);n>-1&&s.splice(n,1)},function(e){console.log(e)})}).catch(function(){})},handleIssue:function(e){var t=this,i=e.voiceText,s=this.currentRobotId;s||0===s?f({soundtext:i,deviceId:s}).then(function(e){t.$message.success(e.msg)},function(e){console.log(e)}):this.$message({message:"请选择正确的机器人下发信息",type:"warning"})},handleSave:function(){var e=this,t=this.temp.voiceId;this.sending||this.$refs["dataForm"].validate(function(i){if(i)if(e.sending=!0,t&&0!==t){var s=e._.findIndex(e.list,{id:t});g(e.temp).then(function(t){e.$message.success(t.msg),e.list.splice(s,1,Object.assign({},e.list[s],e.temp)),e.sending=!1,e.dialogVisible=!1},function(t){e.dialogVisible=!1,console.log(t)})}else p(e.temp).then(function(t){e.$message.success(t.msg),e.sending=!1,e.dialogVisible=!1,e.getList()},function(t){e.sending=!1,console.log(t)})})}}},m=v,b=(i("0cb3"),i("2877")),h=Object(b["a"])(m,s,n,!1,null,"c717b0d0",null);t["default"]=h.exports},a36f:function(e,t,i){}}]);