(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1eb62688"],{"359e":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container new bg with-pagination"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-title"},[i("Toolbar",{attrs:{name:t.filename}},[i("span",{staticClass:"action",on:{click:t.getList}},[i("g-icon",{attrs:{"icon-class":"search"}}),t._v(" "),i("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.search")))])],1),t._v(" "),i("el-dropdown",{staticClass:"action",attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",[i("g-icon",{attrs:{"icon-class":"download"}}),t._v(" "),i("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.download")))])],1),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{"data-table-action":"excel",command:"xlsx"}},[t._v("\n              Excel (.xlsx)\n            ")])],1)],1)],1)],1),t._v(" "),i("h6",{staticClass:"card-subtitle"},[t._v("全数据统计：\n      "),i("span",[t._v("抓拍车辆次数（"),i("em",[t._v(t._s(t._f("defaultValue")(t.statistics.vehicleCaptureCount))+"次")]),t._v(" ）")]),t._v(" "),i("span",[t._v("驱离车辆次数（"),i("em",[t._v(t._s(t._f("defaultValue")(t.statistics.illegalCount))+"次")]),t._v(" ）")]),t._v(" "),i("span",[t._v("抓拍布控车辆次数（"),i("em",[t._v(t._s(t._f("defaultValue")(t.statistics.suspectCount))+"次")]),t._v(" ）")]),t._v(" "),i("span",[t._v("抓拍未年检车辆次数（"),i("em",[t._v(t._s(t._f("defaultValue")(t.statistics.inspectionCount))+"次")]),t._v(" ）")]),t._v(" "),i("span",[t._v("出勤次数（"),i("em",[t._v(t._s(t._f("defaultValue")(t.statistics.dutyCount))+"次")]),t._v(" ）")]),t._v(" "),i("span",[t._v("出勤时间（"),i("em",[t._v("共"+t._s(t._f("filterTimeLength")(t.statistics.dutyTimeCount)))]),t._v(" ）")])]),t._v(" "),i("div",{staticClass:"card-body"},[i("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-input",{staticClass:"filter-item",attrs:{size:t.searchSize,placeholder:"车牌号码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(e)}},model:{value:t.listQuery.vehicleNumber,callback:function(e){t.$set(t.listQuery,"vehicleNumber","string"===typeof e?e.trim():e)},expression:"listQuery.vehicleNumber"}},[i("i",{staticClass:"el-input__icon el-icon-ext-card",attrs:{slot:"prefix"},slot:"prefix"})])],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-date-picker",{staticClass:"filter-item",attrs:{size:t.searchSize,type:"date",placeholder:"开始日期",align:"right","value-format":"yyyy-MM-dd"},model:{value:t.listQuery.startDate,callback:function(e){t.$set(t.listQuery,"startDate",e)},expression:"listQuery.startDate"}})],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-date-picker",{staticClass:"filter-item",attrs:{size:t.searchSize,type:"date",placeholder:"结束日期",align:"right","value-format":"yyyy-MM-dd"},model:{value:t.listQuery.endDate,callback:function(e){t.$set(t.listQuery,"endDate",e)},expression:"listQuery.endDate"}})],1)],1),t._v(" "),i("div",{staticClass:"card-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{"show-summary":"","summary-method":t.handleSummary,data:t.list,"row-key":t.rowKey,fit:"","empty-text":t.emptyText,"highlight-current-row":""},on:{"cell-click":t.handleCellClick}},[i("el-table-column",{attrs:{align:t.tableAlign,label:"出勤日期",prop:"dutyDate"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.dutyDate)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"抓拍车辆次数",prop:"vehicleCaptureCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.vehicleCaptureCount?i("a",{staticStyle:{color:"#409EFF"},attrs:{href:"javascript: void(0)"}},[t._v(t._s(e.row.vehicleCaptureCount))]):[t._v(t._s(t._f("defaultValue")(e.row.vehicleCaptureCount)))]]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"驱离车辆次数",prop:"illegalCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.illegalCount?i("a",{staticStyle:{color:"#409EFF"},attrs:{href:"javascript: void(0)"}},[t._v(t._s(e.row.illegalCount))]):[t._v(t._s(t._f("defaultValue")(e.row.illegalCount)))]]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"抓拍布控车辆次数",prop:"suspectCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.suspectCount?i("a",{staticStyle:{color:"#409EFF"},attrs:{href:"javascript: void(0)"}},[t._v(t._s(e.row.suspectCount))]):[t._v(t._s(t._f("defaultValue")(e.row.suspectCount)))]]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"抓拍未年检车辆次数",prop:"inspectionCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.inspectionCount?i("a",{staticStyle:{color:"#409EFF"},attrs:{href:"javascript: void(0)"}},[t._v(t._s(e.row.inspectionCount))]):[t._v(t._s(t._f("defaultValue")(e.row.inspectionCount)))]]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"出勤次数",prop:"dutyCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.dutyCount)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"出勤时间",prop:"dutyTimeCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("filterTimeLength")(e.row.dutyTimeCount)))]}}])})],1)],1)],1)]),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"append-to-body":!0,top:"8vh",title:t.dialogTitle,visible:t.dialogVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"800px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.captureLoading,expression:"captureLoading"}],staticStyle:{width:"94%",margin:"0 auto"},attrs:{data:t.captureList,"row-key":t.rowKey,fit:"","empty-text":t.emptyText,"highlight-current-row":"",height:"500"}},[i("el-table-column",{attrs:{align:t.tableAlign,label:"车牌号码"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.vehicleNumber)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"上传时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.createTime)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"抓拍机器人ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("defaultValue")(e.row.deviceId)))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("fancyBox",{attrs:{url:t.row.picUrl}})]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container in-dialog"},[i("el-pagination",{attrs:{"current-page":t.listQuery2.page,"page-sizes":[10,30,50,100],"page-size":t.listQuery2.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total2},on:{"size-change":t.handleSizeChange2,"current-change":t.handleCurrentChange2}})],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")]),t._v(" "),i("el-button",{on:{click:function(e){return t.handleCommand2("xlsx")}}},[t._v("导出")])],1)],1)],1)},l=[],s=(i("c5f6"),i("ac6a"),i("0a1f")),n=i("ed08"),o=s["patrol"].getPatrolVehicleReportDetail,r=s["patrol"].getPatrolVehicleReportPage,u={name:"PatrolVehiclesReport",filters:{filterTimeLength:function(t){if("undefined"===typeof t)return"--";var e=parseInt(t)/1e3,i="",a=Math.floor(e/3600);if(a>0){i+=a+"小时",e%=3600;var l=Math.floor(e/60);if(l>0){i+=l+"分钟";var s=e%60;s>0&&(i+=s+"秒")}else e%60!==0&&(i+=e%60+"秒")}else{var n=Math.floor(e/60);if(n>0){i+=n+"分钟";var o=e%60;o>0&&(i+=o+"秒")}else e%60!==0&&(i+=e%60+"秒")}return i||0}},data:function(){var t=new Date;return{filename:this.$t("route.patrol-vehicles-report"),emptyText:null,tableHeight:550,list:[],total:null,listLoading:!0,listQuery:{page:1,limit:10,startDate:Object(n["l"])(t.getTime()-864e5,"{y}-{m}-{d}"),endDate:Object(n["l"])(t.getTime(),"{y}-{m}-{d}"),vehicleNumber:""},dialogTitle:"地图详情",needModal:!0,closeOnClickModel:!1,dialogVisible:!1,statistics:{},captureLoading:!1,listQuery2:{page:1,limit:10,vehicleType:"",dutyDate:"",vehicleNumber:""},total2:null,captureList:[]}},created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,this.emptyText=null,r(this.listQuery).then(function(e){t.list=e.data.rows,t.total=e.data.total,t.statistics=e.data.extend,t.listLoading=!1},function(e){console.log(e),t.listLoading=!1,t.emptyText="网络错误"})},getList2:function(){var t=this;this.captureLoading=!0,this.emptyText=null,o(this.listQuery2).then(function(e){t.captureList=e.data.rows,t.total2=e.data.total,t.captureLoading=!1},function(e){t.emptyText="网络错误",t.captureLoading=!1,console.log(e)})},handleCommand:function(t){if("undefined"!==typeof t)switch(t){case"xlsx":var e=["dutyDate","vehicleCaptureCount","illegalCount","suspectCount","inspectionCount","dutyCount","dutyTimeCount"],i=["出勤日期","抓拍车辆次数","驱离车辆次数","抓拍布控车辆次数","抓拍未年检车辆次数","出勤次数","出勤时间"],a=this.list,l=this.filename;this.$g_exportToExcel({field:e,field_ZH:i,list:a,filename:l},this.formatJson);break}},formatJson:function(t,e){var i=this;return e.map(function(e){return t.map(function(t){return"dutyTimeCount"===t?i.$options.filters.filterTimeLength(e[t]):e[t]})})},rowKey:function(t){return t.id},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleSummary:function(t){var e=this,i=t.columns,a=t.data,l=[];return i.forEach(function(t,i){if(0!==i){var s=a.map(function(e){return Number(e[t.property])});s.every(function(t){return isNaN(t)})?l[i]="N/次":(l[i]=s.reduce(function(t,e){var i=Number(e);return isNaN(i)?t:t+e},0),"dutyTimeCount"!==t.property?l[i]+=" 次":l[i]="共 ".concat(e.$options.filters.filterTimeLength(l[i])))}else l[i]="总计"}),l},handleCellClick:function(t,e,i,a){var l=a.target||a.srcElement,s=e["property"];if("A"!==l.nodeName)return!1;if("vehicleCaptureCount"===s)this.dialogTitle="抓拍车辆",this.listQuery2=Object.assign({},this.listQuery2,{vehicleType:1,vehicleNumber:this.listQuery.vehicleNumber,dutyDate:t["dutyDate"]});else if("illegalCount"===s)this.dialogTitle="驱离车辆",this.listQuery2=Object.assign({},this.listQuery2,{vehicleType:2,vehicleNumber:this.listQuery.vehicleNumber,dutyDate:t["dutyDate"]});else if("suspectCount"===s)this.dialogTitle="布控车辆",this.listQuery2=Object.assign({},this.listQuery2,{vehicleType:3,vehicleNumber:this.listQuery.vehicleNumber,dutyDate:t["dutyDate"]});else{if("inspectionCount"!==s)return!1;this.dialogTitle="过期年检车辆",this.listQuery2=Object.assign({},this.listQuery2,{vehicleType:4,vehicleNumber:this.listQuery.vehicleNumber,dutyDate:t["dutyDate"]})}this.dialogVisible=!0,this.getList2()},handleSizeChange2:function(t){this.listQuery2.limit=t,this.getList2()},handleCurrentChange2:function(t){this.listQuery2.page=t,this.getList2()},handleCommand2:function(t){if("undefined"!==typeof t)switch(t){case"xlsx":var e=["vehicleNumber","createTime","deviceId","picUrl"],i=["车牌号码","上传时间","抓拍机器人ID","图片"],a=this.captureList,l=this.dialogTitle;this.$g_exportToExcel({field:e,field_ZH:i,list:a,filename:l},null);break}}}},c=u,d=(i("3e74"),i("2877")),p=Object(d["a"])(c,a,l,!1,null,"6708f5f4",null);e["default"]=p.exports},"3e74":function(t,e,i){"use strict";var a=i("9632"),l=i.n(a);l.a},9632:function(t,e,i){}}]);