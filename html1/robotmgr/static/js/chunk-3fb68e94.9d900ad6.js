(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fb68e94"],{"386b":function(t,i,e){var o=e("5ca1"),a=e("79e5"),n=e("be13"),s=/"/g,l=function(t,i,e,o){var a=String(n(t)),l="<"+i;return""!==e&&(l+=" "+e+'="'+String(o).replace(s,"&quot;")+'"'),l+">"+a+"</"+i+">"};t.exports=function(t,i){var e={};e[t]=i(l),o(o.P+o.F*a(function(){var i=""[t]('"');return i!==i.toLowerCase()||i.split('"').length>3}),"String",e)}},"4e7b":function(t,i,e){"use strict";var o=e("57f8"),a=e.n(o);a.a},"57f8":function(t,i,e){},d263:function(t,i,e){"use strict";e("386b")("fixed",function(t){return function(){return t(this,"tt","","")}})},dae9:function(t,i,e){"use strict";e.r(i);var o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"app-container new bg"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-title"},[e("Toolbar",{attrs:{name:t.filename}},[e("span",{staticClass:"action",on:{click:t.getList}},[e("g-icon",{attrs:{"icon-class":"search"}}),t._v(" "),e("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.search")))])],1),t._v(" "),e("span",{staticClass:"action",on:{click:function(i){t.sort="desc"===t.sort?"asc":"desc"}}},[e("g-icon",{attrs:{"icon-class":"sort"}}),t._v(" "),e("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.sort")))])],1),t._v(" "),e("span",{staticClass:"action",on:{click:t.handlePlus}},[e("g-icon",{attrs:{"icon-class":"plus"}}),t._v(" "),e("span",{staticClass:"action__desc"},[t._v("添加")])],1)])],1),t._v(" "),e("h6",{staticClass:"card-subtitle"},[t._v("添加、编辑机器人分组，多机器人协同路线计划配置，充电桩配置")]),t._v(" "),e("div",{staticClass:"card-body"},[e("el-row",{attrs:{gutter:50}},[e("transition-group",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{name:"flip-list-scale",tag:"div"}},t._l(t.computedList,function(i){return e("el-col",{key:i.id,staticClass:"flip-list__item",attrs:{lg:8,xl:6}},[e("router-link",{staticClass:"group",attrs:{"data-name":i.groupName,to:"/config-center/multi-robot/detail/"+i.id+"?name="+encodeURIComponent(i.groupName)}},[e("div",{staticClass:"group__title"},[t._v("\n                "+t._s(i.groupName)+"\n                "),0!==i.id?e("div",{staticClass:"group__time"},[t._v("添加时间："+t._s(t._f("parseTime")(i.addTime)))]):t._e()]),t._v(" "),0!==i.id?e("div",{staticClass:"group__actions"},[e("g-icon",{attrs:{"icon-class":"configuration"},on:{click:function(e){return t.handleRobotConfig(e,i)}}}),t._v(" "),e("g-icon",{attrs:{"icon-class":"robot"},on:{click:function(e){return t.handleRobotRelevant(e,i)}}}),t._v(" "),e("g-icon",{attrs:{"icon-class":"edit"},on:{click:function(e){return t.handleEdit(e,i)}}}),t._v(" "),e("g-icon",{attrs:{"icon-class":"delete"},on:{click:function(e){return t.handleDelete(e,i)}}})],1):t._e()])],1)}),1)],1)],1)]),t._v(" "),e("el-dialog",{attrs:{"append-to-body":!0,top:"25vh",title:t.dialogTitle,visible:t.dialogVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"400px"},on:{"update:visible":function(i){t.dialogVisible=i}}},[e("el-form",{ref:"dataForm",staticStyle:{width:"90%",margin:"0 auto"},attrs:{rules:t.rules,model:t.temp,size:t.formSize,"label-position":t.formAlign,"label-width":"60px"}},[e("el-form-item",{attrs:{label:"名称",prop:"groupName"}},[e("el-input",{attrs:{placeholder:""},model:{value:t.temp.groupName,callback:function(i){t.$set(t.temp,"groupName","string"===typeof i?i.trim():i)},expression:"temp.groupName"}})],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){t.dialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.sending,expression:"sending"}],on:{click:t.handleSave}},[t._v("保存")])],1)],1),t._v(" "),e("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"append-to-body":!0,top:"15vh",title:t.dialogTitle,visible:t.dialogRobotVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"700px"},on:{"update:visible":function(i){t.dialogRobotVisible=i}}},[e("div",{staticClass:"relevane"},[e("div",{staticClass:"left fl"},[e("div",{staticClass:"list__title"},[t._v("可选机器人")]),t._v(" "),e("div",{staticClass:"list__wrap"},[e("el-scrollbar",[e("draggable",t._b({staticClass:"list",attrs:{tag:"ul",move:t.onMove},on:{start:function(i){t.drag=!0},end:function(i){t.drag=!1}},model:{value:t.list_f,callback:function(i){t.list_f=i},expression:"list_f"}},"draggable",t.dragOptions,!1),t._l(t.list_f,function(i){return e("li",{key:i.id,staticClass:"list-item",attrs:{draggable:""}},[e("div",{staticClass:"icon__wrap"},[e("i",{staticClass:"gosuncn-icon el-icon-ext-robot"})]),t._v(" "),e("span",[t._v(t._s(i.name))])])}),0)],1)],1)]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"list__title"},[t._v("已添加的机器人")]),t._v(" "),e("div",{staticClass:"list__wrap"},[e("el-scrollbar",[e("draggable",t._b({staticClass:"list",attrs:{tag:"ul",move:t.onMove},on:{start:function(i){t.drag2=!0},end:function(i){t.drag2=!1}},model:{value:t.list_r,callback:function(i){t.list_r=i},expression:"list_r"}},"draggable",t.dragOptions,!1),t._l(t.list_r,function(i){return e("li",{key:i.id,staticClass:"list-item",attrs:{draggable:""}},[e("div",{staticClass:"icon__wrap"},[e("i",{staticClass:"gosuncn-icon el-icon-ext-robot"})]),t._v(" "),e("span",[t._v(t._s(i.name))])])}),0)],1)],1)])]),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){t.dialogRobotVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.sending,expression:"sending"}],on:{click:t.handleSaveRobot}},[t._v("保存")])],1)]),t._v(" "),e("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"append-to-body":!0,top:"25vh",title:"机器人分组配置",visible:t.dialogConfigVisible,modal:t.needModal,"close-on-click-modal":t.closeOnClickModel,width:"700px"},on:{"update:visible":function(i){t.dialogConfigVisible=i}}},[e("el-form",{ref:"configForm",staticStyle:{width:"90%",margin:"0 auto"},attrs:{rules:t.rules,model:t.temp_config,size:t.formSize,"label-position":t.formAlign,"label-width":"340px"}},[e("el-form-item",{attrs:{label:"多机器人协同巡逻充电任务开关"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"rgba(19, 206, 102, 0.4)"},model:{value:t.temp_config.config.Multirobot_Auto_Patrol,callback:function(i){t.$set(t.temp_config.config,"Multirobot_Auto_Patrol",i)},expression:"temp_config.config.Multirobot_Auto_Patrol"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"低于此电量值就发命令让机器人去充电（%）"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{placeholder:"填入",controls:!1,min:1,max:100},model:{value:t.temp_config.config.Auto_Patrol_LowPower_Value,callback:function(i){t.$set(t.temp_config.config,"Auto_Patrol_LowPower_Value",i)},expression:"temp_config.config.Auto_Patrol_LowPower_Value"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"机器人充电要达到此安全电量值后才可以出来（%）"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{placeholder:"填入",controls:!1,min:1,max:100},model:{value:t.temp_config.config.Auto_Patrol_SafePower_Value,callback:function(i){t.$set(t.temp_config.config,"Auto_Patrol_SafePower_Value",i)},expression:"temp_config.config.Auto_Patrol_SafePower_Value"}})],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){t.dialogConfigVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.sending,expression:"sending"}],on:{click:t.saveConfig}},[t._v("保存")])],1)],1)],1)},a=[],n=(e("d263"),e("ac6a"),e("20d6"),e("55dd"),e("310e")),s=e.n(n),l=e("ed08"),c=e("0a1f"),r=c["device"].batchGrouping,d=c["device"].searchRobotList,u=c["device"].addOrModifyDeviceGroup,g=c["device"].deleteDeviceGroup,f=c["device"].selectDeviceGroup,_={name:"MultiRobot",components:{draggable:s.a},data:function(){return{emptyText:null,list:[],total:null,listLoading:!0,formSize:"mini",listQuery:{page:1,limit:10},dialogTitle:"添加分组",needModal:!0,closeOnClickModel:!1,dialogVisible:!1,dialogRobotVisible:!1,sending:!1,rules:{groupName:[{required:!0,message:"不能为空",trigger:"blur"}]},temp:{groupName:"",id:""},temp_batch:{groupId:"",ids:""},sort:"asc",list_f:[],list_r:[],drag:!1,drag2:!1,dragOptions:{animation:200,group:"description",disabled:!1,ghostClass:"ghost"},dialogConfigVisible:!1,temp_config:{id:"",groupName:"",config:{Auto_Patrol_LowPower_Value:1,Auto_Patrol_SafePower_Value:1,Multirobot_Auto_Patrol:0}},filename:this.$t("route.multi-robot")}},computed:{computedList:function(){var t=this.list,i=this.sort;return t.sort(function(t,e){return t.hasOwnProperty("addTime")?e.hasOwnProperty("addTime")?"desc"===i?Object(l["d"])(t.addTime)-Object(l["d"])(e.addTime):Object(l["d"])(e.addTime)-Object(l["d"])(t.addTime):-1:1})},computeedConf:{get:function(){var t=this.temp_config,i=this._.cloneDeep(t);return i.config=JSON.stringify(i.config),i}}},created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,this.emptyText=null,f(this.listQuery).then(function(i){t.list=i.data,t.listLoading=!1},function(i){console.log(i),t.listLoading=!1,t.emptyText="网络错误"})},handlePlus:function(){var t=this;this.dialogTitle="添加分组",this.temp={id:"",groupName:""},this.dialogVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},handleEdit:function(t,i){var e=this;t.preventDefault&&t.preventDefault();var o=i.id,a=i.groupName;this.temp=Object.assign({},this.temp,{id:o,groupName:a}),this.dialogTitle="编辑分组",this.dialogVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},handleDelete:function(t,i){var e=this;t.preventDefault&&t.preventDefault();var o=i.id,a=this.list;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){g({id:o}).then(function(t){e.$message.success(t.msg);var o=a.indexOf(i);o>-1&&a.splice(o,1)},function(t){console.log(t)})}).catch(function(){})},handleSave:function(){var t=this,i=this.temp.id,e=u;this.$refs["dataForm"].validate(function(o){if(o){var a=t._.cloneDeep(t.temp);t.sending=!0,e(a).then(function(e){t.$message.success(e.msg),t.sending=!1;var o=t.list;i?o.splice(t._.findIndex(o,{id:i}),1,e.data):o.splice(0,0,e.data),t.$nextTick(function(){t.dialogVisible=!1})},function(i){t.sending=!1,console.log(i)})}})},handleRobotRelevant:function(t,i){var e=this;t.preventDefault&&t.preventDefault();var o=i.id;this.temp_batch.groupId=o,d({page:1,limit:9999}).then(function(t){e.list_f=[],e.list_r=[];var i=t.data.rows;i.forEach(function(t){+t.groupId===+o?e.list_r.push(t):e.list_f.push(t)})},function(t){console.log(t)}),this.dialogTitle="管理机器人分组",this.$nextTick(function(){e.dialogRobotVisible=!0})},onMove:function(t){var i=t.relatedContext,e=t.draggedContext,o=i.element,a=e.element;return(!o||!o.fixed)&&!a.fixed},handleSaveRobot:function(){var t=this,i=this.temp_batch;i.ids=this.list_r.map(function(t){return t.id}).join(","),this.sending=!0,r(i).then(function(i){t.sending=!1,t.dialogRobotVisible=!1,t.$message.success(i.msg)},function(i){t.sending=!1,console.log(i)})},handleRobotConfig:function(t,i){t.preventDefault&&t.preventDefault();var e=i.id,o=i.groupName,a=null;try{a=JSON.parse(i.config)}catch(n){a=null}a?Object.assign(this.temp_config,{id:e,groupName:o,config:a}):Object.assign(this.temp_config,{id:e,groupName:o,config:{Auto_Patrol_LowPower_Value:1,Auto_Patrol_SafePower_Value:1,Multirobot_Auto_Patrol:0}}),this.dialogConfigVisible=!0},saveConfig:function(){var t=this,i=this.computeedConf;this.sending=!0,u(i).then(function(e){t.sending=!1,t.$message.success(e.msg);var o=t.list,a=i.id,n=t._.findIndex(o,{id:a});n&&o.splice(n,1,e.data),t.dialogConfigVisible=!1},function(i){t.sending=!1,console.log(i)})}}},p=_,v=(e("4e7b"),e("2877")),m=Object(v["a"])(p,o,a,!1,null,"d2c5b646",null);i["default"]=m.exports}}]);