(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8c21d3d8"],{"254d":function(t,e,i){"use strict";i.r(e);var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container bg new with-pagination"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-title"},[i("Toolbar",{attrs:{name:t.filename}},[i("span",{staticClass:"action",on:{click:t.getList}},[i("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" "),i("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.search")))])],1),t._v(" "),i("el-dropdown",{staticClass:"action",attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",[i("svg-icon",{attrs:{"icon-class":"download"}}),t._v(" "),i("span",{staticClass:"action__desc"},[t._v(t._s(t.$t("base.download")))])],1),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{"data-table-action":"excel",command:"xlsx"}},[t._v("\n              Excel (.xlsx)\n            ")])],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"card-body"},[i("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-input",{staticClass:"filter-item",attrs:{size:t.searchSize,placeholder:"姓名"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(e)}},model:{value:t.listQuery.visitorName,callback:function(e){t.$set(t.listQuery,"visitorName",e)},expression:"listQuery.visitorName"}},[i("svg-icon",{attrs:{slot:"prefix","class-name":"el-input__icon","icon-class":"user"},slot:"prefix"})],1)],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-input",{staticClass:"filter-item",attrs:{size:t.searchSize,placeholder:"身份证号码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(e)}},model:{value:t.listQuery.idNumber,callback:function(e){t.$set(t.listQuery,"idNumber",e)},expression:"listQuery.idNumber"}},[i("svg-icon",{attrs:{slot:"prefix","class-name":"el-input__icon","icon-class":"credentials"},slot:"prefix"})],1)],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-select",{staticClass:"filter-item",attrs:{clearable:"",placeholder:"是否在黑名单",size:t.searchSize},on:{change:t.getList},model:{value:t.listQuery.inBlackList,callback:function(e){t.$set(t.listQuery,"inBlackList",e)},expression:"listQuery.inBlackList"}},[t._l(t.selectOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),t._v(" "),i("svg-icon",{attrs:{slot:"prefix","class-name":"el-input__icon","icon-class":"list"},slot:"prefix"})],2)],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-date-picker",{staticClass:"filter-item",attrs:{size:t.searchSize,type:"datetime",placeholder:"开始时间",align:"right","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.listQuery.startTime,callback:function(e){t.$set(t.listQuery,"startTime",e)},expression:"listQuery.startTime"}})],1),t._v(" "),i("el-col",{attrs:{xs:12,sm:8,md:4}},[i("el-date-picker",{staticClass:"filter-item",attrs:{size:t.searchSize,type:"datetime",placeholder:"结束时间",align:"right","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.listQuery.endTime,callback:function(e){t.$set(t.listQuery,"endTime",e)},expression:"listQuery.endTime"}})],1)],1),t._v(" "),i("div",{staticClass:"card-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":t.rowKey,fit:"","empty-text":t.emptyText,"highlight-current-row":""}},[i("el-table-column",{attrs:{align:t.tableAlign,label:"姓名",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.visitorName))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"性别",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.visitorGender))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"电话",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.telNum))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"身份证号码"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.idNumber))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"来访单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.visitUnit))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"来访时间",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.visitTime))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"来访事由"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.visitReason))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"黑名单"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s("1"===e.row.inBlackList?"是":"否"))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"照片",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("fancyBox",{attrs:{url:t.row.picUrl}})]}}])}),t._v(" "),i("el-table-column",{attrs:{align:t.tableAlign,label:"操作",fixed:"right",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{class:["1"===e.row.inBlackList?"el-icon-ext-delete":"el-icon-ext-plus","card-table__icon"],staticStyle:{cursor:"pointer"},on:{click:function(i){return t.handleInBlackList(e.row)}}})]}}])})],1)],1)],1)]),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])},n=[],s=i("0a1f"),a=i("ed08"),r=s["device"].qryVisitorInfo,o=s["device"].addBlackList,c={name:"VisitorsQuery",data:function(){return{emptyText:null,list:[],total:null,listLoading:!0,pickerOptions:a["m"],listQuery:{page:1,limit:10,visitorName:null,idNumber:null,startTime:null,endTime:null,inBlackList:null},selectOptions:[{value:"1",label:"是"},{value:"0",label:"否"}],filename:this.$t("route.visitors-query")}},created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,this.emptyText=null,r(this.listQuery).then(function(e){t.list=e.data.rows,t.total=e.data.total,t.listLoading=!1},function(e){console.log(e),t.listLoading=!1,t.emptyText="网络错误"})},rowKey:function(t){return t.id},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleCommand:function(t){if("undefined"!==typeof t)switch(t){case"xlsx":var e=["visitorName","visitorGender","telNum","idNumber","visitUnit","visitTime","visitReason","inBlackList","picUrl"],i=["姓名","性别","电话","身份证号码","来访单位","来访时间","来访事由","是否在黑名单","照片"],l=this.list,n=this.filename;this.$g_exportToExcel({field:e,field_ZH:i,list:l,filename:n},this.formatJson);break}},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},handleInBlackList:function(t){var e=this,i=t.inBlackList,l=t.visitorName,n=t.picUrl;"1"===i?this.$confirm("执行黑名单移除操作","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message.warning("该功能暂未开发 ~ ~")}).catch(function(){}):this.$confirm("执行添加到黑名单的操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o({name:l,avatar:n}).then(function(t){e.$message.success(t.msg)},function(t){console.log(t)})}).catch(function(){})}}},u=c,d=(i("6eb4"),i("2877")),m=Object(d["a"])(u,l,n,!1,null,"5f53973b",null);e["default"]=m.exports},"6eb4":function(t,e,i){"use strict";var l=i("e6b0"),n=i.n(l);n.a},e6b0:function(t,e,i){}}]);